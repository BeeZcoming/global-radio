<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…¨çƒå¹¿æ’­ç”µå°åœ¨çº¿æ”¶å¬</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            color: #fff;
            min-height: 100vh;
            overflow-x: hidden;
            padding-bottom: 120px;
        }

        .container {
            display: flex;
            max-width: 1800px;
            margin: 0 auto;
            padding: 20px;
            gap: 20px;
        }

        header {
            text-align: center;
            padding: 20px 0;
            background: rgba(0, 0, 0, 0.3);
            margin-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(90deg, #ff8a00, #e52e71);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 0 10px rgba(229, 46, 113, 0.5);
        }

        .tagline {
            font-size: 1.1rem;
            color: #aaa;
            margin-bottom: 10px;
        }

        .search-container {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .search-box {
            flex: 1;
            min-width: 250px;
            position: relative;
        }

        .search-box input {
            width: 100%;
            padding: 12px 20px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 30px;
            color: white;
            font-size: 1rem;
            outline: none;
            transition: all 0.3s;
        }

        .search-box input:focus {
            border-color: #e52e71;
            box-shadow: 0 0 10px rgba(229, 46, 113, 0.5);
        }

        .search-box i {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: #aaa;
        }

        .filter-container {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }

        select {
            padding: 10px 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 30px;
            color: white;
            font-size: 0.9rem;
            outline: none;
            cursor: pointer;
            transition: all 0.3s;
            flex: 1;
            min-width: 120px;
        }

        select:focus {
            border-color: #ff8a00;
            box-shadow: 0 0 10px rgba(255, 138, 0, 0.5);
        }

        option {
            background: #302b63;
        }

        /* è‡ªå®šä¹‰å¤šåˆ—ä¸‹æ‹‰èœå• */
        .custom-select {
            position: relative;
            flex: 1;
            min-width: 120px;
        }

        .select-selected {
            padding: 10px 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 30px;
            color: white;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .select-selected:after {
            content: "â–¼";
            font-size: 0.7rem;
            transition: all 0.3s;
        }

        .select-selected.select-arrow-active:after {
            transform: rotate(180deg);
        }

        .select-selected:hover {
            border-color: #ff8a00;
        }

        .select-items {
            position: absolute;
            background: rgba(0, 0, 0, 0.9);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            top: 100%;
            left: 0;
            right: 0;
            z-index: 99;
            max-height: 500px;
            overflow-y: auto;
            display: none;
            padding: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        .select-items.active {
            display: block;
        }

        .select-header {
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 10px;
            padding-bottom: 8px;
        }

        .select-header .select-item {
            background: rgba(255, 138, 0, 0.15) !important;
            border: 1px solid rgba(255, 138, 0, 0.3) !important;
            font-weight: 600;
            margin-bottom: 5px;
            padding: 10px 12px;
        }

        .select-hot-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 6px;
            margin-bottom: 15px;
        }

        .select-hot-grid .select-item {
            background: rgba(229, 46, 113, 0.1);
            border: 1px solid rgba(229, 46, 113, 0.2);
            text-align: center;
            padding: 8px 4px;
            font-size: 0.8rem;
            border-radius: 6px;
        }

        .select-hot-grid .select-item:hover {
            background: rgba(229, 46, 113, 0.2);
            transform: translateY(-1px);
        }

        .select-columns {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }

        .select-category {
            margin-bottom: 0;
        }

        .category-title {
            font-size: 0.85rem;
            color: #ff8a00;
            margin-bottom: 8px;
            padding-bottom: 5px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .select-item {
            padding: 6px 8px;
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.3s;
            font-size: 0.8rem;
            color: #ddd;
            margin-bottom: 4px;
        }

        .select-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(3px);
        }

        .select-item.active {
            background: rgba(255, 138, 0, 0.2);
            color: #ff8a00;
            font-weight: 500;
        }

        .hot-genre::after {
            content: " ğŸ”¥";
            font-size: 0.7rem;
        }

        .sidebar {
            flex: 0 0 350px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 10px 20px 0px 20px; /* ä¸Š å³ ä¸‹ å·¦ */
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            max-height: calc(100vh - 200px);
            overflow: hidden;
        }

        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .map-container {
            flex: 1;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 10px 20px 20px 20px; /* ä¸Š å³ ä¸‹ å·¦ */
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
        }

        .section-title {
            font-size: 1.3rem;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            color: #ff8a00;
        }

        .radio-list {
            flex: 1;
            overflow-y: auto;
            margin-top: 10px;
        }

        .radio-item {
            display: flex;
            align-items: center;
            padding: 8px 12px;
            margin-bottom: 6px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            transition: all 0.3s;
            cursor: pointer;
            border: 1px solid transparent;
        }

        .radio-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            border-color: rgba(255, 138, 0, 0.3);
        }

        .radio-item.active {
            background: rgba(229, 46, 113, 0.2);
            border-color: rgba(229, 46, 113, 0.5);
        }

        .radio-flag {
            width: 30px;
            height: 20px;
            border-radius: 3px;
            margin-right: 10px;
            font-size: 1.2rem;
            text-align: center;
        }

        .radio-info {
            flex: 1;
            min-width: 0;
        }

        .radio-name {
            font-weight: 600;
            margin-bottom: 3px;
            font-size: 0.9rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .radio-country, .radio-genre {
            font-size: 0.75rem;
            color: #aaa;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .play-btn {
            background: #e52e71;
            color: white;
            border: none;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            flex-shrink: 0;
        }

        .play-btn:hover {
            background: #ff8a00;
            transform: scale(1.1);
        }

        #map {
            flex: 1;
            width: 100%;
            height: 100%;
            min-height: 500px;
            border-radius: 10px;
            overflow: hidden;
        }

        .country-info {
            margin-top: 20px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }

        .country-name {
            font-size: 1.2rem;
            color: #ff8a00;
            margin-bottom: 10px;
        }

        .player {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            padding: 15px 30px;
            display: flex;
            align-items: center;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            z-index: 1000;
        }

        .player-info {
            flex: 1;
            margin-left: 20px;
        }

        .player-station {
            font-weight: 600;
            font-size: 1.1rem;
            margin-bottom: 5px;
        }

        .player-country {
            color: #aaa;
            font-size: 0.9rem;
        }

        .player-controls {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .control-btn {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .control-btn:hover {
            color: #ff8a00;
        }

        .play-pause {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: #e52e71;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .play-pause:hover {
            background: #ff8a00;
        }

        .volume-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .volume-slider {
            width: 100px;
        }

        /* éŸ³è´¨é€‰æ‹©å™¨åœ¨æ’­æ”¾å™¨ä½ç½® */
        .quality-container {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-left: 10px;
        }

        .quality-select {
            padding: 5px 10px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            color: white;
            font-size: 0.8rem;
            outline: none;
            cursor: pointer;
            transition: all 0.3s;
        }

        .quality-select:focus {
            border-color: #ff8a00;
        }

        .quality-indicator {
            font-size: 0.7rem;
            color: #aaa;
            margin-left: 5px;
        }

        .now-playing {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-right: 20px;
            padding: 10px 15px;
            background: rgba(255, 138, 0, 0.2);
            border-radius: 30px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 138, 0, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(255, 138, 0, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 138, 0, 0); }
        }

        .now-playing i {
            color: #ff8a00;
        }

        .loading {
            text-align: center;
            padding: 20px;
            color: #aaa;
        }

        .error {
            text-align: center;
            padding: 20px;
            color: #e52e71;
        }

        .stats {
            display: flex;
            justify-content: space-between;
            margin: 10px 0;
            font-size: 0.8rem;
            color: #aaa;
        }

        .favorite-btn {
            background: none;
            border: none;
            color: #aaa;
            font-size: 1rem;
            cursor: pointer;
            margin-right: 8px;
            transition: all 0.3s;
            flex-shrink: 0;
        }

        .favorite-btn.active {
            color: #ff8a00;
        }

        .tabs {
            display: flex;
            margin-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .tab {
            padding: 8px 15px;
            cursor: pointer;
            transition: all 0.3s;
            border-bottom: 2px solid transparent;
            font-size: 0.9rem;
        }

        .tab.active {
            color: #ff8a00;
            border-bottom: 2px solid #ff8a00;
        }

        .tab:hover {
            color: #ff8a00;
        }

        .tab-content {
            display: none;
            flex: 1;
            overflow-y: auto;
        }

        .tab-content.active {
            display: flex;
            flex-direction: column;
        }

        .history-item {
            display: flex;
            align-items: center;
            padding: 8px;
            margin-bottom: 6px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            transition: all 0.3s;
            cursor: pointer;
        }

        .history-item:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .history-time {
            font-size: 0.65rem;
            color: #aaa;
            margin-top: 2px;
        }

        .share-btn {
            background: none;
            border: none;
            color: #aaa;
            font-size: 1.2rem;
            cursor: pointer;
            margin-right: 10px;
            transition: all 0.3s;
            position: relative;
        }

        .share-btn:hover {
            color: #2196F3;
        }

        .share-menu {
            position: absolute;
            bottom: 100%;
            right: 0;
            background: rgba(0, 0, 0, 0.9);
            border-radius: 10px;
            padding: 10px;
            display: none;
            flex-direction: column;
            gap: 8px;
            min-width: 150px;
            z-index: 1001;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .share-menu.active {
            display: flex;
        }

        .share-option {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            color: white;
            text-decoration: none;
        }

        .share-option:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .share-option i {
            width: 20px;
            text-align: center;
        }

        .load-more {
            text-align: center;
            padding: 15px 10px 25px 10px;
            margin-top: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
        }

        .load-more-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
        }

        .load-more-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: #ff8a00;
            transform: translateY(-2px);
        }

        .region-selector {
            display: flex;
            gap: 5px;
            margin-bottom: 10px;
        }

        .region-btn {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: #aaa;
            padding: 6px 8px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.75rem;
            flex: 1;
            text-align: center;
        }

        .region-btn.active {
            background: rgba(255, 138, 0, 0.2);
            color: #ff8a00;
            border-color: rgba(255, 138, 0, 0.5);
        }

        .region-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        /* æ•°æ®æºæ˜¾ç¤ºåœ¨ç”µå°åˆ—è¡¨å¹¶æ’å³å¯¹é½ */
        .data-source-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 5px;
            padding: 8px 0;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .data-source {
            font-size: 0.7rem;
            color: #aaa;
            text-align: right;
            flex: 1;
        }

        /* è„‰å†²åŠ¨ç”»æ ·å¼ */
        .pulsing-marker {
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.2); opacity: 0.7; }
            100% { transform: scale(1); opacity: 1; }
        }

        /* ä¼˜åŒ–åçš„æ¬¢è¿æç¤ºæ ·å¼ */
        .welcome-notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255, 138, 0, 0.9);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            z-index: 1002;
            display: flex;
            align-items: center;
            gap: 10px;
            animation: slideDown 0.5s ease-out;
            max-width: 500px;
            width: 90%;
        }

        @keyframes slideDown {
            from { top: -100px; opacity: 0; }
            to { top: 20px; opacity: 1; }
        }

        .welcome-notification .close-btn {
            background: none;
            border: none;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            margin-left: auto;
        }

        .welcome-content {
            flex: 1;
        }

        .welcome-title {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .welcome-details {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        /* åˆ†äº«æˆåŠŸæç¤º */
        .share-success {
            position: fixed;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(33, 150, 243, 0.9);
            color: white;
            padding: 10px 20px;
            border-radius: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            z-index: 1002;
            display: flex;
            align-items: center;
            gap: 10px;
            animation: fadeInOut 3s ease-in-out;
        }

        @keyframes fadeInOut {
            0% { opacity: 0; transform: translateX(-50%) translateY(20px); }
            20% { opacity: 1; transform: translateX(-50%) translateY(0); }
            80% { opacity: 1; transform: translateX(-50%) translateY(0); }
            100% { opacity: 0; transform: translateX(-50%) translateY(-20px); }
        }

        /* å¾®ä¿¡åˆ†äº«æŒ‡å¼• */
        .wechat-share-guide {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1003;
        }

        .wechat-share-guide > div {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            max-width: 400px;
            width: 90%;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 1200px) {
            .container {
                flex-direction: column;
            }
            
            .sidebar {
                flex: 1;
                max-height: 500px;
            }
            
            .map-container {
                min-height: 600px;
            }
            
            .select-columns {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .search-container {
                flex-direction: column;
            }
            
            .search-box {
                min-width: 100%;
            }
            
            .player {
                flex-direction: column;
                gap: 15px;
                padding: 15px;
            }
            
            .player-controls {
                width: 100%;
                justify-content: center;
            }
            
            .sidebar {
                flex: 0 0 auto;
            }
            
            body {
                padding-bottom: 160px;
            }

            .region-selector {
                flex-wrap: wrap;
            }

            .region-btn {
                flex: 0 0 calc(33.333% - 5px);
            }

            .select-columns {
                grid-template-columns: 1fr;
            }
            
            .select-hot-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .welcome-notification {
                top: 10px;
                left: 10px;
                right: 10px;
                transform: none;
                max-width: none;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1><i class="fas fa-globe-americas"></i> å…¨çƒå¹¿æ’­ç”µå°</h1>
        <p class="tagline">æ¢ç´¢ä¸–ç•Œå„åœ°çš„å¹¿æ’­ç”µå°ï¼Œéšæ—¶æ”¶å¬å…¨çƒå£°éŸ³</p>
    </header>

    <div class="container">
        <div class="sidebar">
            <h2 class="section-title">ç”µå°åˆ—è¡¨</h2>
            
            <div class="search-container">
                <div class="search-box">
                    <input type="text" id="search-input" placeholder="æœç´¢ç”µå°åç§°ã€å›½å®¶æˆ–ç”µå°åˆ†ç±»...">
                    <i class="fas fa-search"></i>
                </div>
            </div>
            
            <div class="region-selector">
                <button class="region-btn active" data-region="all">å…¨éƒ¨</button>
                <button class="region-btn" data-region="asia">äºšæ´²</button>
                <button class="region-btn" data-region="europe">æ¬§æ´²</button>
                <button class="region-btn" data-region="north-america">åŒ—ç¾æ´²</button>
                <button class="region-btn" data-region="south-america">å—ç¾æ´²</button>
                <button class="region-btn" data-region="africa">éæ´²</button>
                <button class="region-btn" data-region="oceania">å¤§æ´‹æ´²</button>
            </div>
            
            <div class="filter-container">
                <select id="country-filter">
                    <option value="">æ‰€æœ‰å›½å®¶</option>
                </select>
                <select id="language-filter">
                    <option value="">æ‰€æœ‰è¯­è¨€</option>
                </select>
                
                <!-- è‡ªå®šä¹‰åˆ†ç±»é€‰æ‹©å™¨ -->
                <div class="custom-select" id="genre-select">
                    <!-- å†…å®¹ç”±JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
            
            <div class="stats">
                <span id="total-stations">åŠ è½½ä¸­...</span>
                <span id="filtered-stations"></span>
            </div>
            
            <!-- æ•°æ®æºæ˜¾ç¤ºåŒºåŸŸ -->
            
            <div class="tabs">
                <div class="tab active" data-tab="all">å…¨éƒ¨ç”µå°</div>
                <div class="tab" data-tab="favorites">æ”¶è—</div>
                <div class="tab" data-tab="history">æ’­æ”¾å†å²</div>
            </div>
            
            <div class="tab-content active" id="all-stations">
                <div class="radio-list" id="radio-list">
                    <div class="loading">
                        <i class="fas fa-spinner fa-spin"></i> æ­£åœ¨åŠ è½½ç”µå°åˆ—è¡¨...
                    </div>
                </div>
                <div class="load-more">
                    <button class="load-more-btn" id="load-more-btn" style="display: none;">åŠ è½½æ›´å¤šç”µå°</button>
                </div>
				<div class="data-source-container">
					<div></div> <!-- å ä½å…ƒç´  -->
					<div class="data-source" id="data-source">æ•°æ®æ¥æº: ZYDS.NET | åœ°åŒº: æ‰€æœ‰åœ°åŒº</div>
				</div>				
            </div>
            
            <div class="tab-content" id="favorites-stations">
                <div class="radio-list" id="favorites-list">
                    <div class="loading">æš‚æ— æ”¶è—çš„ç”µå°</div>
                </div>
            </div>
            
            <div class="tab-content" id="history-stations">
                <div class="radio-list" id="history-list">
                    <div class="loading">æš‚æ— æ’­æ”¾å†å²</div>
                </div>
            </div>
        </div>
        
        <div class="main-content">
            <div class="map-container">
                <h2 class="section-title">ä¸–ç•Œç”µå°åœ°å›¾</h2>
                <div id="map"></div>
                <div class="country-info">
                    <div class="country-name" id="selected-country">å…¨çƒç”µå°</div>
                    <p id="country-station-count">ç‚¹å‡»åœ°å›¾ä¸Šçš„æ ‡è®°æˆ–ä½¿ç”¨ç­›é€‰å™¨é€‰æ‹©ç”µå°</p>
                </div>
            </div>
        </div>
    </div>
    
    <div class="player">
        <div class="now-playing">
            <i class="fas fa-music"></i>
            <span>æ­£åœ¨æ’­æ”¾</span>
        </div>
        
        <div class="player-info">
            <div class="player-station" id="current-station">è¯·é€‰æ‹©ä¸€ä¸ªç”µå°å¼€å§‹æ’­æ”¾</div>
            <div class="player-country" id="current-country"></div>
        </div>
        
        <div class="player-controls">
            <button class="control-btn play-pause" id="play-pause-btn"><i class="fas fa-play"></i></button>
            <button class="control-btn stop-btn" id="stop-btn"><i class="fas fa-stop"></i></button>
            
            <div class="volume-container">
                <button class="control-btn volume-btn"><i class="fas fa-volume-up"></i></button>
                <input type="range" class="volume-slider" min="0" max="100" value="80">
            </div>

            <!-- éŸ³è´¨é€‰æ‹©å™¨ç§»åŠ¨åˆ°æ’­æ”¾å™¨ä½ç½® -->
            <div class="quality-container">
                <span style="font-size: 0.8rem; color: #aaa;">éŸ³è´¨:</span>
                <select class="quality-select" id="quality-select">
                    <option value="auto">è‡ªåŠ¨</option>
                    <option value="high">é«˜éŸ³è´¨</option>
                    <option value="medium">ä¸­éŸ³è´¨</option>
                    <option value="low">ä½éŸ³è´¨</option>
                </select>
                <span class="quality-indicator" id="quality-indicator"></span>
            </div>

            <div class="share-container">
                <button class="control-btn share-btn" id="share-btn">
                    <i class="fas fa-share-alt"></i>
                </button>
                <div class="share-menu" id="share-menu">
                    <a href="#" class="share-option" data-platform="copy-link">
                        <i class="fas fa-link"></i>
                        <span>å¤åˆ¶åˆ†äº«é“¾æ¥</span>
                    </a>
                    <a href="#" class="share-option" data-platform="wechat">
                        <i class="fab fa-weixin"></i>
                        <span>å¾®ä¿¡</span>
                    </a>
                    <a href="#" class="share-option" data-platform="weibo">
                        <i class="fab fa-weibo"></i>
                        <span>å¾®åš</span>
                    </a>
                    <a href="#" class="share-option" data-platform="qq">
                        <i class="fab fa-qq"></i>
                        <span>QQ</span>
                    </a>
                    <a href="#" class="share-option" data-platform="twitter">
                        <i class="fab fa-twitter"></i>
                        <span>Twitter</span>
                    </a>
                    <a href="#" class="share-option" data-platform="facebook">
                        <i class="fab fa-facebook"></i>
                        <span>Facebook</span>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script>
        // åˆå§‹åŒ–å˜é‡
        let currentStation = null;
        let isPlaying = false;
        let audioPlayer = new Audio();
        let allStations = [];
        let filteredStations = [];
        let displayedStations = [];
        let favoriteStations = [];
        let historyStations = [];
        let map;
        let markers = [];
        let countries = [];
        let languages = [];
        let genres = [];
        let searchTimeout;
        let activeTab = 'all';
        let currentRegion = 'all';
        let currentQuality = 'auto';
        let currentGenre = 'all';
        let displayLimit = 200;
        let displayedCount = 0;
        let mapUpdateTimeout;

        // æ•°æ®æºé…ç½® - åªä½¿ç”¨åœ°åŒºæ•°æ®æº
        const DATA_SOURCES = {
            asia: 'data/asia-stations.json',
            europe: 'data/europe-stations.json',
            'north-america': 'data/north-america-stations.json',
            'south-america': 'data/south-america-stations.json',
            africa: 'data/africa-stations.json',
            oceania: 'data/oceania-stations.json',
            fallback: 'https://de1.api.radio-browser.info/json/stations?limit=100&hidebroken=true&order=votes&reverse=true'
        };

        // åœ°åŒºåç§°æ˜ å°„
        const regionNames = {
            'all': 'æ‰€æœ‰åœ°åŒº',
            'asia': 'äºšæ´²', 'europe': 'æ¬§æ´²', 'africa': 'éæ´²', 
            'north-america': 'åŒ—ç¾æ´²', 'south-america': 'å—ç¾æ´²', 'oceania': 'å¤§æ´‹æ´²'
        };

        // æ‰©å±•è¯­è¨€æ˜ å°„ - åŒ…å«æ›´å¤šä¸»æµè¯­è¨€
        const languageMapping = {
            // è”åˆå›½å®˜æ–¹è¯­è¨€
            'chinese': 'ä¸­æ–‡', 'english': 'è‹±è¯­', 'french': 'æ³•è¯­', 'russian': 'ä¿„è¯­',
            'spanish': 'è¥¿ç­ç‰™è¯­', 'arabic': 'é˜¿æ‹‰ä¼¯è¯­',
            
            // æ¬§æ´²ä¸»è¦è¯­è¨€
            'german': 'å¾·è¯­', 'italian': 'æ„å¤§åˆ©è¯­', 'portuguese': 'è‘¡è„ç‰™è¯­', 'dutch': 'è·å…°è¯­',
            'polish': 'æ³¢å…°è¯­', 'ukrainian': 'ä¹Œå…‹å…°è¯­', 'romanian': 'ç½—é©¬å°¼äºšè¯­', 'greek': 'å¸Œè…Šè¯­',
            'czech': 'æ·å…‹è¯­', 'hungarian': 'åŒˆç‰™åˆ©è¯­', 'bulgarian': 'ä¿åŠ åˆ©äºšè¯­', 'swedish': 'ç‘å…¸è¯­',
            'norwegian': 'æŒªå¨è¯­', 'danish': 'ä¸¹éº¦è¯­', 'finnish': 'èŠ¬å…°è¯­', 'croatian': 'å…‹ç½—åœ°äºšè¯­',
            'serbian': 'å¡å°”ç»´äºšè¯­', 'slovak': 'æ–¯æ´›ä¼å…‹è¯­', 'slovenian': 'æ–¯æ´›æ–‡å°¼äºšè¯­',
            
            // äºšæ´²ä¸»è¦è¯­è¨€
            'japanese': 'æ—¥è¯­', 'korean': 'éŸ©è¯­', 'hindi': 'å°åœ°è¯­', 'bengali': 'å­ŸåŠ æ‹‰è¯­',
            'urdu': 'ä¹Œå°”éƒ½è¯­', 'persian': 'æ³¢æ–¯è¯­', 'turkish': 'åœŸè€³å…¶è¯­', 'thai': 'æ³°è¯­',
            'vietnamese': 'è¶Šå—è¯­', 'malay': 'é©¬æ¥è¯­', 'indonesian': 'å°å°¼è¯­', 'filipino': 'è²å¾‹å®¾è¯­',
            'burmese': 'ç¼…ç”¸è¯­', 'khmer': 'æŸ¬åŸ”å¯¨è¯­', 'lao': 'è€æŒè¯­', 'mongolian': 'è’™å¤è¯­',
            
            // éæ´²ä¸»è¦è¯­è¨€
            'swahili': 'æ–¯ç“¦å¸Œé‡Œè¯­', 'hausa': 'è±ªè¨è¯­', 'yoruba': 'çº¦é²å·´è¯­', 'amharic': 'é˜¿å§†å“ˆæ‹‰è¯­',
            'somali': 'ç´¢é©¬é‡Œè¯­', 'zulu': 'ç¥–é²è¯­', 'afrikaans': 'å—éè·å…°è¯­',
            
            // å…¶ä»–é‡è¦è¯­è¨€
            'hebrew': 'å¸Œä¼¯æ¥è¯­', 'tamil': 'æ³°ç±³å°”è¯­', 'telugu': 'æ³°å¢å›ºè¯­', 'marathi': 'é©¬æ‹‰åœ°è¯­',
            'gujarati': 'å¤å‰æ‹‰ç‰¹è¯­', 'punjabi': 'æ—é®æ™®è¯­', 'kannada': 'å¡çº³è¾¾è¯­', 'malayalam': 'é©¬æ‹‰é›…æ‹‰å§†è¯­',
            
            // å…¶ä»–è¯­è¨€å½’ç±»
            'other': 'å…¶ä»–è¯­è¨€'
        };

        // å®Œæ•´çš„å›½å®¶åç§°ä¸­è‹±æ–‡æ˜ å°„ - ä¿®å¤ç‰ˆ
        const countryNameMapping = {
            // äºšæ´²
            'China': 'ä¸­å›½', 'Japan': 'æ—¥æœ¬', 'South Korea': 'éŸ©å›½', 'North Korea': 'æœé²œ',
            'India': 'å°åº¦', 'Indonesia': 'å°åº¦å°¼è¥¿äºš', 'Thailand': 'æ³°å›½', 'Vietnam': 'è¶Šå—',
            'Malaysia': 'é©¬æ¥è¥¿äºš', 'Philippines': 'è²å¾‹å®¾', 'Singapore': 'æ–°åŠ å¡', 'Taiwan': 'å°æ¹¾',
            'Hong Kong': 'é¦™æ¸¯', 'Macao': 'æ¾³é—¨', 'Pakistan': 'å·´åŸºæ–¯å¦', 'Bangladesh': 'å­ŸåŠ æ‹‰å›½',
            'Sri Lanka': 'æ–¯é‡Œå…°å¡', 'Nepal': 'å°¼æ³Šå°”', 'Myanmar': 'ç¼…ç”¸', 'Cambodia': 'æŸ¬åŸ”å¯¨',
            'Laos': 'è€æŒ', 'The Lao Peoples Democratic Republic': 'è€æŒ', 'Lao Peoples Democratic Republic': 'è€æŒ',
            'Mongolia': 'è’™å¤', 'Afghanistan': 'é˜¿å¯Œæ±—', 'Bhutan': 'ä¸ä¸¹',
            'Brunei': 'æ–‡è±', 'Maldives': 'é©¬å°”ä»£å¤«', 'Timor-Leste': 'ä¸œå¸æ±¶', 'Timor Leste': 'ä¸œå¸æ±¶',
            'Kazakhstan': 'å“ˆè¨å…‹æ–¯å¦', 'Uzbekistan': 'ä¹Œå…¹åˆ«å…‹æ–¯å¦', 'Turkmenistan': 'åœŸåº“æ›¼æ–¯å¦',
            'Kyrgyzstan': 'å‰å°”å‰æ–¯æ–¯å¦', 'Tajikistan': 'å¡”å‰å…‹æ–¯å¦',
            'Iran': 'ä¼Šæœ—', 'Iraq': 'ä¼Šæ‹‰å…‹', 'Saudi Arabia': 'æ²™ç‰¹é˜¿æ‹‰ä¼¯', 'United Arab Emirates': 'é˜¿è”é…‹',
            'Turkey': 'åœŸè€³å…¶', 'TÃ¼rkiye': 'åœŸè€³å…¶', 'Israel': 'ä»¥è‰²åˆ—', 'Lebanon': 'é»å·´å«©', 
            'Jordan': 'çº¦æ—¦', 'Syria': 'å™åˆ©äºš', 'Yemen': 'ä¹Ÿé—¨', 'Oman': 'é˜¿æ›¼', 'Qatar': 'å¡å¡”å°”',
            'Kuwait': 'ç§‘å¨ç‰¹', 'Bahrain': 'å·´æ—', 'Palestine': 'å·´å‹’æ–¯å¦', 'Cyprus': 'å¡æµ¦è·¯æ–¯',
            'Armenia': 'äºšç¾å°¼äºš', 'Azerbaijan': 'é˜¿å¡æ‹œç–†', 'Georgia': 'æ ¼é²å‰äºš',
            
            // æ¬§æ´²
            'United Kingdom': 'è‹±å›½', 'Germany': 'å¾·å›½', 'France': 'æ³•å›½', 'Italy': 'æ„å¤§åˆ©',
            'Spain': 'è¥¿ç­ç‰™', 'Netherlands': 'è·å…°', 'Sweden': 'ç‘å…¸', 'Norway': 'æŒªå¨',
            'Finland': 'èŠ¬å…°', 'Denmark': 'ä¸¹éº¦', 'Switzerland': 'ç‘å£«', 'Austria': 'å¥¥åœ°åˆ©',
            'Russia': 'ä¿„ç½—æ–¯', 'Belgium': 'æ¯”åˆ©æ—¶', 'Ireland': 'çˆ±å°”å…°', 'Portugal': 'è‘¡è„ç‰™',
            'Poland': 'æ³¢å…°', 'Ukraine': 'ä¹Œå…‹å…°', 'Czech Republic': 'æ·å…‹', 'Czechia': 'æ·å…‹',
            'Hungary': 'åŒˆç‰™åˆ©', 'Romania': 'ç½—é©¬å°¼äºš', 'Greece': 'å¸Œè…Š', 'Bulgaria': 'ä¿åŠ åˆ©äºš',
            'Serbia': 'å¡å°”ç»´äºš', 'Croatia': 'å…‹ç½—åœ°äºš', 'Slovakia': 'æ–¯æ´›ä¼å…‹', 'Belarus': 'ç™½ä¿„ç½—æ–¯',
            'Lithuania': 'ç«‹é™¶å®›', 'Latvia': 'æ‹‰è„±ç»´äºš', 'Estonia': 'çˆ±æ²™å°¼äºš', 'Slovenia': 'æ–¯æ´›æ–‡å°¼äºš',
            'Luxembourg': 'å¢æ£®å ¡', 'Malta': 'é©¬è€³ä»–', 'Iceland': 'å†°å²›', 'Albania': 'é˜¿å°”å·´å°¼äºš',
            'Bosnia and Herzegovina': 'æ³¢é»‘', 'Bosnia And Herzegovina': 'æ³¢é»‘',
            'Macedonia': 'åŒ—é©¬å…¶é¡¿', 'Montenegro': 'é»‘å±±', 'Kosovo': 'ç§‘ç´¢æ²ƒ', 'Moldova': 'æ‘©å°”å¤šç“¦',
            'Andorra': 'å®‰é“å°”', 'Monaco': 'æ‘©çº³å“¥', 'San Marino': 'åœ£é©¬åŠ›è¯º', 'Vatican City': 'æ¢µè’‚å†ˆ',
            'Liechtenstein': 'åˆ—æ”¯æ•¦å£«ç™»',
            
            // åŒ—ç¾æ´²
            'United States': 'ç¾å›½', 'Canada': 'åŠ æ‹¿å¤§', 'Mexico': 'å¢¨è¥¿å“¥', 'Cuba': 'å¤å·´',
            'Dominican Republic': 'å¤šç±³å°¼åŠ ', 'Haiti': 'æµ·åœ°', 'Jamaica': 'ç‰™ä¹°åŠ ', 'Bahamas': 'å·´å“ˆé©¬',
            'Puerto Rico': 'æ³¢å¤šé»å„', 'Guatemala': 'å±åœ°é©¬æ‹‰', 'Honduras': 'æ´ªéƒ½æ‹‰æ–¯', 'El Salvador': 'è¨å°”ç“¦å¤š',
            'Nicaragua': 'å°¼åŠ æ‹‰ç“œ', 'Costa Rica': 'å“¥æ–¯è¾¾é»åŠ ', 'Panama': 'å·´æ‹¿é©¬', 
            'Trinidad and Tobago': 'ç‰¹ç«‹å°¼è¾¾å’Œå¤šå·´å“¥', 'Trinidad And Tobago': 'ç‰¹ç«‹å°¼è¾¾å’Œå¤šå·´å“¥',
            'Barbados': 'å·´å·´å¤šæ–¯', 'Belize': 'ä¼¯åˆ©å…¹', 'Saint Lucia': 'åœ£å¢è¥¿äºš', 'Grenada': 'æ ¼æ—çº³è¾¾',
            'Saint Vincent and the Grenadines': 'åœ£æ–‡æ£®ç‰¹å’Œæ ¼æ—çº³ä¸æ–¯', 
            'Saint Vincent And The Grenadines': 'åœ£æ–‡æ£®ç‰¹å’Œæ ¼æ—çº³ä¸æ–¯',
            'Antigua and Barbuda': 'å®‰æç“œå’Œå·´å¸ƒè¾¾', 'Antigua And Barbuda': 'å®‰æç“œå’Œå·´å¸ƒè¾¾',
            'Dominica': 'å¤šç±³å°¼å…‹', 
            'Saint Kitts and Nevis': 'åœ£åŸºèŒ¨å’Œå°¼ç»´æ–¯', 'Saint Kitts And Nevis': 'åœ£åŸºèŒ¨å’Œå°¼ç»´æ–¯',
            
            // å—ç¾æ´²
            'Brazil': 'å·´è¥¿', 'Argentina': 'é˜¿æ ¹å»·', 'Chile': 'æ™ºåˆ©', 'Colombia': 'å“¥ä¼¦æ¯”äºš',
            'Peru': 'ç§˜é²', 'Venezuela': 'å§”å†…ç‘æ‹‰', 'Ecuador': 'å„ç“œå¤šå°”', 'Bolivia': 'ç»åˆ©ç»´äºš',
            'Paraguay': 'å·´æ‹‰åœ­', 'Uruguay': 'ä¹Œæ‹‰åœ­', 'Guyana': 'åœ­äºšé‚£', 'Suriname': 'è‹é‡Œå—',
            'French Guiana': 'æ³•å±åœ­äºšé‚£',
            
            // éæ´²
            'South Africa': 'å—é', 'Egypt': 'åŸƒåŠ', 'Nigeria': 'å°¼æ—¥åˆ©äºš', 'Kenya': 'è‚¯å°¼äºš',
            'Morocco': 'æ‘©æ´›å“¥', 'Ethiopia': 'åŸƒå¡ä¿„æ¯”äºš', 'Ghana': 'åŠ çº³', 'Tanzania': 'å¦æ¡‘å°¼äºš',
            'Algeria': 'é˜¿å°”åŠåˆ©äºš', 'Uganda': 'ä¹Œå¹²è¾¾', 'Sudan': 'è‹ä¸¹', 'Angola': 'å®‰å“¥æ‹‰',
            'Mozambique': 'è«æ¡‘æ¯”å…‹', 'Madagascar': 'é©¬è¾¾åŠ æ–¯åŠ ', 'Cameroon': 'å–€éº¦éš†', 
            "CÃ´te d'Ivoire": 'ç§‘ç‰¹è¿ªç“¦', 'Coted Ivoire': 'ç§‘ç‰¹è¿ªç“¦', 
            'Democratic Republic of the Congo': 'åˆšæœ(é‡‘)', 
            'The Democratic Republic Of The Congo': 'åˆšæœ(é‡‘)', 
            'Republic of the Congo': 'åˆšæœ(å¸ƒ)', 'The Congo': 'åˆšæœ', 
            'Zimbabwe': 'æ´¥å·´å¸ƒéŸ¦', 'Zambia': 'èµæ¯”äºš', 'Senegal': 'å¡å†…åŠ å°”', 
            'Mali': 'é©¬é‡Œ', 'Burkina Faso': 'å¸ƒåŸºçº³æ³•ç´¢', 'Niger': 'å°¼æ—¥å°”', 'Chad': 'ä¹å¾—', 
            'Somalia': 'ç´¢é©¬é‡Œ', 'Rwanda': 'å¢æ—ºè¾¾', 'Burundi': 'å¸ƒéš†è¿ª', 'Tunisia': 'çªå°¼æ–¯', 
            'Libya': 'åˆ©æ¯”äºš', 'Namibia': 'çº³ç±³æ¯”äºš', 'Botswana': 'åšèŒ¨ç“¦çº³', 'Lesotho': 'è±ç´¢æ‰˜', 
            'Eswatini': 'æ–¯å¨å£«å…°', 'Mauritania': 'æ¯›é‡Œå¡”å°¼äºš', 'Benin': 'è´å®', 'Togo': 'å¤šå“¥', 
            'Sierra Leone': 'å¡æ‹‰åˆ©æ˜‚', 'Liberia': 'åˆ©æ¯”é‡Œäºš', 'Central African Republic': 'ä¸­éå…±å’Œå›½', 
            'South Sudan': 'å—è‹ä¸¹', 'Eritrea': 'å„ç«‹ç‰¹é‡Œäºš', 'Djibouti': 'å‰å¸ƒæ', 'Comoros': 'ç§‘æ‘©ç½—', 
            'Cape Verde': 'ä½›å¾—è§’', 'Cabo Verde': 'ä½›å¾—è§’', 
            'Sao Tome and Principe': 'åœ£å¤šç¾å’Œæ™®æ—è¥¿æ¯”', 'Sao Tome And Principe': 'åœ£å¤šç¾å’Œæ™®æ—è¥¿æ¯”', 
            'Mauritius': 'æ¯›é‡Œæ±‚æ–¯', 'Seychelles': 'å¡èˆŒå°”', 'Guinea': 'å‡ å†…äºš', 
            'Guinea-Bissau': 'å‡ å†…äºšæ¯”ç»', 'Equatorial Guinea': 'èµ¤é“å‡ å†…äºš', 'Gabon': 'åŠ è“¬', 
            'Gambia': 'å†ˆæ¯”äºš', 'Western Sahara': 'è¥¿æ’’å“ˆæ‹‰', 'Malawi': 'é©¬æ‹‰ç»´',
            
            // å¤§æ´‹æ´²
            'Australia': 'æ¾³å¤§åˆ©äºš', 'New Zealand': 'æ–°è¥¿å…°', 'Fiji': 'æ–æµ', 
            'Papua New Guinea': 'å·´å¸ƒäºšæ–°å‡ å†…äºš', 'Samoa': 'è¨æ‘©äºš', 'Tonga': 'æ±¤åŠ ', 
            'Vanuatu': 'ç“¦åŠªé˜¿å›¾', 'Solomon Islands': 'æ‰€ç½—é—¨ç¾¤å²›', 'Kiribati': 'åŸºé‡Œå·´æ–¯', 
            'Micronesia': 'å¯†å…‹ç½—å°¼è¥¿äºš', 'Palau': 'å¸•åŠ³', 'Marshall Islands': 'é©¬ç»å°”ç¾¤å²›',
            'Nauru': 'ç‘™é²', 'Tuvalu': 'å›¾ç“¦å¢', 'New Caledonia': 'æ–°å–€é‡Œå¤šå°¼äºš', 
            'French Polynesia': 'æ³•å±æ³¢åˆ©å°¼è¥¿äºš',
            
            // ç‰¹æ®Šåœ°åŒº
            'Aland Islands': 'å¥¥å…°ç¾¤å²›', 'Anguilla': 'å®‰åœ­æ‹‰', 'Antarctica': 'å—ææ´²', 
            'Aruba': 'é˜¿é²å·´', 'Ascension And Tristan Da Cunha Saint Helena': 'åœ£èµ«å‹’æ‹¿', 
            'Bermuda': 'ç™¾æ…•å¤§', 'Bonaire': 'åšå¥ˆå°”', 'British Virgin Islands': 'è‹±å±ç»´å°”äº¬ç¾¤å²›', 
            'Christmas Island': 'åœ£è¯å²›', 'Curacao': 'åº“æ‹‰ç´¢', 'Gibraltar': 'ç›´å¸ƒç½—é™€', 
            'Greenland': 'æ ¼é™µå…°', 'Guadeloupe': 'ç“œå¾·ç½—æ™®', 'Guam': 'å…³å²›', 'Guernsey': 'æ ¹è¥¿å²›', 
            'Isle Of Man': 'é©¬æ©å²›', 'Martinique': 'é©¬æå°¼å…‹', 'Mayotte': 'é©¬çº¦ç‰¹', 
            'Montserrat': 'è’™ç‰¹å¡æ‹‰ç‰¹', 'Niue': 'çº½åŸƒ', 'Reunion': 'ç•™å°¼æ±ª', 
            'Saint Pierre And Miquelon': 'åœ£çš®åŸƒå°”å’Œå¯†å…‹éš†', 'Svalbard And Jan Mayen': 'æ–¯ç“¦å°”å·´', 
            'The Cayman Islands': 'å¼€æ›¼ç¾¤å²›', 'The Cocos Keeling Islands': 'ç§‘ç§‘æ–¯ç¾¤å²›', 
            'The Cook Islands': 'åº“å…‹ç¾¤å²›', 'The Falkland Islands Malvinas': 'ç¦å…‹å…°ç¾¤å²›', 
            'The Faroe Islands': 'æ³•ç½—ç¾¤å²›', 'The French Southern Territories': 'æ³•å±å—éƒ¨é¢†åœ°', 
            'The Holy See': 'æ¢µè’‚å†ˆ', 'The Turks And Caicos Islands': 'ç‰¹å…‹æ–¯å’Œå‡¯ç§‘æ–¯ç¾¤å²›', 
            'US Virgin Islands': 'ç¾å±ç»´å°”äº¬ç¾¤å²›', 'Wallis And Futuna': 'ç“¦åˆ©æ–¯å’Œå¯Œå›¾çº³'
        };

        // æ‰©å±•åˆ†ç±»æ˜ å°„
        const genreMapping = {
            // éŸ³ä¹åˆ†ç±»
            'pop': 'æµè¡ŒéŸ³ä¹', 'rock': 'æ‘‡æ»šéŸ³ä¹', 'classical': 'å¤å…¸éŸ³ä¹', 'jazz': 'çˆµå£«éŸ³ä¹',
            'electronic': 'ç”µå­éŸ³ä¹', 'country': 'ä¹¡æ‘éŸ³ä¹', 'folk': 'æ°‘è°£éŸ³ä¹', 'blues': 'è“è°ƒéŸ³ä¹',
            'hiphop': 'å˜»å“ˆéŸ³ä¹', 'rap': 'è¯´å”±éŸ³ä¹', 'metal': 'é‡‘å±éŸ³ä¹', 'indie': 'ç‹¬ç«‹éŸ³ä¹',
            'dance': 'èˆæ›²éŸ³ä¹', 'latin': 'æ‹‰ä¸éŸ³ä¹', 'world': 'ä¸–ç•ŒéŸ³ä¹', 'oldies': 'ç»å…¸è€æ­Œ',
            'top40': 'æµè¡Œé‡‘æ›²', 'hits': 'çƒ­é—¨é‡‘æ›²', 'rnb': 'èŠ‚å¥è“è°ƒ', 'r&b': 'èŠ‚å¥è“è°ƒ', 
            'edm': 'ç”µå­èˆæ›²', 'kpop': 'éŸ©æµéŸ³ä¹', 'jpop': 'æ—¥æµéŸ³ä¹', 'cpop': 'åè¯­æµè¡Œ',
            
            // èµ„è®¯èŠ‚ç›®
            'news': 'æ–°é—»èµ„è®¯', 'talk': 'è°ˆè¯èŠ‚ç›®', 'business': 'è´¢ç»èŠ‚ç›®', 'politics': 'æ”¿æ²»èŠ‚ç›®', 
            'sports': 'ä½“è‚²èŠ‚ç›®', 'weather': 'å¤©æ°”é¢„æŠ¥', 'traffic': 'äº¤é€šä¿¡æ¯', 'current affairs': 'æ—¶äº‹è¯„è®º',
            
            // æ–‡åŒ–æ•™è‚²
            'education': 'æ•™è‚²èŠ‚ç›®', 'culture': 'æ–‡åŒ–èŠ‚ç›®', 'religious': 'å®—æ•™èŠ‚ç›®', 'history': 'å†å²èŠ‚ç›®',
            'science': 'ç§‘å­¦èŠ‚ç›®', 'technology': 'ç§‘æŠ€èŠ‚ç›®', 'arts': 'è‰ºæœ¯èŠ‚ç›®', 'literature': 'æ–‡å­¦èŠ‚ç›®',
            
            // å¨±ä¹ç”Ÿæ´»
            'entertainment': 'å¨±ä¹èŠ‚ç›®', 'comedy': 'å–œå‰§èŠ‚ç›®', 'lifestyle': 'ç”Ÿæ´»èŠ‚ç›®', 'health': 'å¥åº·èŠ‚ç›®',
            'fashion': 'æ—¶å°šèŠ‚ç›®', 'food': 'ç¾é£ŸèŠ‚ç›®', 'travel': 'æ—…æ¸¸èŠ‚ç›®', 'fitness': 'å¥èº«èŠ‚ç›®',
            
            // ç‰¹æ®Šåˆ†ç±»
            'children': 'å„¿ç«¥èŠ‚ç›®', 'family': 'å®¶åº­èŠ‚ç›®', 'community': 'ç¤¾åŒºèŠ‚ç›®', 'local': 'æœ¬åœ°èŠ‚ç›®',
            'regional': 'åŒºåŸŸèŠ‚ç›®', 'national': 'å…¨å›½èŠ‚ç›®', 'international': 'å›½é™…èŠ‚ç›®', 'public': 'å…¬å…±å¹¿æ’­',
            'college': 'å¤§å­¦ç”µå°', 'student': 'å­¦ç”Ÿç”µå°'
        };

        // çƒ­é—¨åˆ†ç±»åˆ—è¡¨
        const popularGenres = ['æµè¡ŒéŸ³ä¹', 'æ–°é—»èµ„è®¯', 'æ‘‡æ»šéŸ³ä¹', 'å¤å…¸éŸ³ä¹', 'è°ˆè¯èŠ‚ç›®', 'ä½“è‚²èŠ‚ç›®'];

        // åœ°åŒºå›½å®¶æ˜ å°„ - 7ä¸ªæ´² - æ‰©å±•ç‰ˆ
        const regionCountries = {
            'asia': [
                'China', 'Japan', 'South Korea', 'North Korea', 'India', 'Indonesia', 'Thailand', 'Vietnam', 
                'Malaysia', 'Philippines', 'Singapore', 'Taiwan', 'Hong Kong', 'Macao', 'Pakistan', 'Bangladesh', 
                'Sri Lanka', 'Nepal', 'Myanmar', 'Cambodia', 'Laos', 'Mongolia', 'Afghanistan', 'Bhutan',
                'Brunei', 'Maldives', 'Timor-Leste', 'Kazakhstan', 'Uzbekistan', 'Turkmenistan', 'Kyrgyzstan', 
                'Tajikistan', 'Iran', 'Iraq', 'Saudi Arabia', 'United Arab Emirates', 'Turkey', 'Israel', 
                'Lebanon', 'Jordan', 'Syria', 'Yemen', 'Oman', 'Qatar', 'Kuwait', 'Bahrain', 'Palestine', 
                'Cyprus', 'Armenia', 'Azerbaijan', 'Georgia'
            ],
            
            'europe': [
                'United Kingdom', 'Germany', 'France', 'Italy', 'Spain', 'Netherlands', 'Sweden', 
                'Norway', 'Finland', 'Denmark', 'Switzerland', 'Austria', 'Russia', 'Belgium', 
                'Ireland', 'Portugal', 'Poland', 'Ukraine', 'Czech Republic', 'Hungary', 'Romania',
                'Greece', 'Bulgaria', 'Serbia', 'Croatia', 'Slovakia', 'Belarus', 'Lithuania',
                'Latvia', 'Estonia', 'Slovenia', 'Luxembourg', 'Malta', 'Iceland', 'Albania',
                'Bosnia and Herzegovina', 'Macedonia', 'Montenegro', 'Kosovo', 'Moldova',
                'Andorra', 'Monaco', 'San Marino', 'Vatican City', 'Liechtenstein'
            ],
            
            'north-america': [
                'United States', 'Canada', 'Mexico', 'Cuba', 'Dominican Republic', 'Haiti', 'Jamaica',
                'Bahamas', 'Puerto Rico', 'Guatemala', 'Honduras', 'El Salvador', 'Nicaragua', 
                'Costa Rica', 'Panama', 'Trinidad and Tobago', 'Barbados', 'Belize', 'Saint Lucia',
                'Grenada', 'Saint Vincent and the Grenadines', 'Antigua and Barbuda', 'Dominica',
                'Saint Kitts and Nevis'
            ],
            
            'south-america': [
                'Brazil', 'Argentina', 'Chile', 'Colombia', 'Peru', 'Venezuela', 'Ecuador', 'Bolivia',
                'Paraguay', 'Uruguay', 'Guyana', 'Suriname', 'French Guiana'
            ],
            
            'africa': [
                'South Africa', 'Egypt', 'Nigeria', 'Kenya', 'Morocco', 'Ethiopia', 'Ghana', 
                'Tanzania', 'Algeria', 'Uganda', 'Sudan', 'Angola', 'Mozambique', 'Madagascar',
                'Cameroon', "CÃ´te d'Ivoire", 'Democratic Republic of the Congo', 'Republic of the Congo',
                'Zimbabwe', 'Zambia', 'Senegal', 'Mali', 'Burkina Faso', 'Niger', 'Chad', 'Somalia',
                'Rwanda', 'Burundi', 'Tunisia', 'Libya', 'Namibia', 'Botswana', 'Lesotho', 'Eswatini',
                'Mauritania', 'Benin', 'Togo', 'Sierra Leone', 'Liberia', 'Central African Republic',
                'South Sudan', 'Eritrea', 'Djibouti', 'Comoros', 'Cape Verde', 'Sao Tome and Principe',
                'Mauritius', 'Seychelles', 'Guinea', 'Guinea-Bissau', 'Equatorial Guinea', 'Gabon',
                'Gambia', 'Western Sahara'
            ],
            
            'oceania': [
                'Australia', 'New Zealand', 'Fiji', 'Papua New Guinea', 'Samoa', 'Tonga', 'Vanuatu',
                'Solomon Islands', 'Kiribati', 'Micronesia', 'Palau', 'Marshall Islands', 'Nauru', 'Tuvalu',
                'New Caledonia', 'French Polynesia'
            ]
        };

        // ä»åœ°åŒºJSONæ–‡ä»¶åŠ è½½æ•°æ®
        async function loadPreprocessedData() {
            console.log('å¼€å§‹åŠ è½½åœ°åŒºæ•°æ®...');
            const loadingElement = document.getElementById('radio-list');
            loadingElement.innerHTML = '<div class="loading"><i class="fas fa-spinner fa-spin"></i> æ­£åœ¨åŠ è½½ç”µå°æ•°æ®...</div>';
            
            try {
                // ç›´æ¥åŠ è½½åœ°åŒºæ•°æ®
                const stations = await loadRegionalData('all');
                
                if (stations && stations.length > 0) {
                    console.log(`âœ… ä»åœ°åŒºæ–‡ä»¶åŠ è½½äº† ${stations.length} ä¸ªç”µå°`);
                    processStationsData(stations);
                    updateDataSource('ZYDS.NET', 'æ‰€æœ‰åœ°åŒº');
                    return;
                }
                
                // å¦‚æœæœ¬åœ°æ•°æ®ä¸å¯ç”¨ï¼Œä½¿ç”¨å¤‡ç”¨API
                console.log('ZYDS.NETæ•°æ®ä¸å¯ç”¨ï¼Œä½¿ç”¨å¤‡ç”¨API...');
                await loadFallbackData();
                
            } catch (error) {
                console.error('æ•°æ®åŠ è½½å¤±è´¥:', error);
                await loadFallbackData();
            }
        }

        // åŠ è½½åœ°åŒºæ•°æ®
        async function loadRegionalData(region = 'all') {
            const regionalSources = [
                DATA_SOURCES.asia,
                DATA_SOURCES.europe,
                DATA_SOURCES['north-america'],
                DATA_SOURCES['south-america'],
                DATA_SOURCES.africa,
                DATA_SOURCES.oceania
            ];
            
            let allStations = [];
            const seenUuids = new Set();
            
            // å¦‚æœæ˜¯ç‰¹å®šåœ°åŒºï¼ŒåªåŠ è½½è¯¥åœ°åŒºæ•°æ®
            const sourcesToLoad = region === 'all' ? regionalSources : [DATA_SOURCES[region]];
            
            for (const source of sourcesToLoad) {
                try {
                    const response = await fetch(source);
                    if (!response.ok) continue;
                    
                    const data = await response.json();
                    const stations = data.stations || [];
                    
                    // ä¸¥æ ¼å»é‡
                    stations.forEach(station => {
                        if (station && station.stationuuid && !seenUuids.has(station.stationuuid)) {
                            seenUuids.add(station.stationuuid);
                            allStations.push(station);
                        }
                    });
                    
                    console.log(`âœ… ä» ${source} åŠ è½½äº† ${stations.length} ä¸ªç”µå°ï¼Œå»é‡åæ–°å¢ ${allStations.length} ä¸ª`);
                    
                } catch (error) {
                    console.warn(`æ— æ³•åŠ è½½åœ°åŒºæ•°æ® ${source}:`, error);
                }
            }
            
            console.log(`ğŸ“Š åœ°åŒºæ•°æ®æ€»è®¡: ${allStations.length} ä¸ªå”¯ä¸€ç”µå°`);
            return allStations;
        }

        // åŠ è½½ç‰¹å®šåœ°åŒºæ•°æ®
        async function loadRegionData(region) {
            try {
                updateDataSource('ZYDS.NET', regionNames[region]);
                
                const stations = await loadRegionalData(region);
                if (stations && stations.length > 0) {
                    // æ›´æ–°å…¨å±€æ•°æ®
                    allStations = stations;
                    
                    // é‡ç½®ç­›é€‰çŠ¶æ€
                    filteredStations = [...allStations];
                    displayedCount = 0;
                    displayedStations = [];
                    
                    // é‡æ–°æå–ç­›é€‰é€‰é¡¹
                    extractFilterOptions();
                    
                    // æ›´æ–°åœ°å›¾
                    updateMapMarkers(allStations.slice(0, 200));
                    
                    // é‡æ–°æ¸²æŸ“åˆ—è¡¨
                    if (activeTab === 'all') {
                        loadMoreStations();
                    }
                    
                    console.log(`âœ… åŠ è½½ ${region} åœ°åŒºæ•°æ®æˆåŠŸ: ${stations.length} ä¸ªç”µå°`);
                    return true;
                }
            } catch (error) {
                console.error(`åŠ è½½ ${region} åœ°åŒºæ•°æ®å¤±è´¥:`, error);
            }
            return false;
        }

        // åŠ è½½å¤‡ç”¨APIæ•°æ®
        async function loadFallbackData() {
            console.log('æ­£åœ¨ä»Radio Browser APIè·å–æ•°æ®...');
            updateDataSource('Zyds Radio API', regionNames[currentRegion]);
            
            try {
                const response = await fetch(DATA_SOURCES.fallback);
                const stations = await response.json();
                
                if (stations && stations.length > 0) {
                    processStationsData(stations);
                    console.log(`âœ… ä»APIåŠ è½½äº† ${stations.length} ä¸ªç”µå°`);
                } else {
                    throw new Error('APIè¿”å›ç©ºæ•°æ®');
                }
            } catch (error) {
                console.error('å¤‡ç”¨APIåŠ è½½å¤±è´¥:', error);
                // æœ€åä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®
                const mockStations = generateMockStations();
                processStationsData(mockStations);
                updateDataSource('æ¨¡æ‹Ÿæ•°æ®', regionNames[currentRegion]);
            }
        }

        // ç”Ÿæˆæ¨¡æ‹Ÿç”µå°æ•°æ®
        function generateMockStations() {
            const stations = [];
            const countries = ['ä¸­å›½', 'ç¾å›½', 'è‹±å›½', 'æ—¥æœ¬', 'å¾·å›½', 'æ³•å›½', 'æ¾³å¤§åˆ©äºš', 'åŠ æ‹¿å¤§', 'å·´è¥¿', 'ä¿„ç½—æ–¯'];
            const languages = ['ä¸­æ–‡', 'è‹±è¯­', 'æ—¥è¯­', 'å¾·è¯­', 'æ³•è¯­', 'è¥¿ç­ç‰™è¯­'];
            const genres = ['æµè¡ŒéŸ³ä¹', 'æ–°é—»èµ„è®¯', 'è°ˆè¯èŠ‚ç›®', 'ä½“è‚²èŠ‚ç›®', 'å¤å…¸éŸ³ä¹', 'æ‘‡æ»šéŸ³ä¹'];
            
            for (let i = 1; i <= 100; i++) {
                const country = countries[Math.floor(Math.random() * countries.length)];
                const language = languages[Math.floor(Math.random() * languages.length)];
                const genre = genres[Math.floor(Math.random() * genres.length)];
                
                // æ¨¡æ‹ŸéŸ³è´¨ä¿¡æ¯
                const qualityTags = ['high', 'medium', 'low'];
                const quality = qualityTags[Math.floor(Math.random() * qualityTags.length)];
                
                stations.push({
                    stationuuid: `station-${i}`,
                    name: `${country}${genre}ç”µå°${i}`,
                    country: country,
                    countrycode: getCountryCode(country),
                    url_resolved: `https://example.com/stream${i}.mp3`,
                    tags: `${genre},${quality}`,
                    language: language,
                    votes: Math.floor(Math.random() * 1000),
                    geo_lat: 20 + Math.random() * 50,
                    geo_long: -120 + Math.random() * 240,
                    bitrate: quality === 'high' ? 320 : (quality === 'medium' ? 128 : 64)
                });
            }
            
            return stations;
        }

        // è·å–å›½å®¶ä»£ç 
        function getCountryCode(country) {
            const codes = {
                'ä¸­å›½': 'CN', 'ç¾å›½': 'US', 'è‹±å›½': 'GB', 'æ—¥æœ¬': 'JP', 
                'å¾·å›½': 'DE', 'æ³•å›½': 'FR', 'æ¾³å¤§åˆ©äºš': 'AU', 'åŠ æ‹¿å¤§': 'CA',
                'å·´è¥¿': 'BR', 'ä¿„ç½—æ–¯': 'RU'
            };
            return codes[country] || 'UN';
        }

        // è·å–ä¸­æ–‡å›½å®¶åç§° - æ”¹è¿›ç‰ˆæœ¬
        function getChineseCountryName(englishName) {
            if (!englishName) return 'æœªçŸ¥å›½å®¶';
            
            // æ¸…ç†å›½å®¶åç§°ï¼ˆç§»é™¤ "The" ç­‰å‰ç¼€ï¼‰
            const cleanName = englishName.replace(/^The\s+/i, '').trim();
            
            // 1. ç›´æ¥æ˜ å°„
            if (countryNameMapping[englishName]) {
                return countryNameMapping[englishName];
            }
            
            // 2. æ¸…ç†åçš„åç§°æ˜ å°„
            if (countryNameMapping[cleanName]) {
                return countryNameMapping[cleanName];
            }
            
            // 3. ç‰¹æ®Šå¤„ç†è€æŒçš„å¤æ‚åç§°
            if (englishName.includes('Lao Peoples')) {
                return 'è€æŒ';
            }
            
            // 4. å¤„ç†"And"å’Œ"The"ç­‰è¿æ¥è¯
            const normalizedName = englishName
                .replace(/\s+And\s+/gi, ' and ')
                .replace(/\s+The\s+/gi, ' the ')
                .replace(/^\s*The\s+/i, '');
            
            if (countryNameMapping[normalizedName]) {
                return countryNameMapping[normalizedName];
            }
            
            // 5. æ¨¡ç³ŠåŒ¹é… - å¤„ç†åŒ…å«é¢å¤–ä¿¡æ¯çš„å›½å®¶å
            for (const [key, value] of Object.entries(countryNameMapping)) {
                const normalizedKey = key.toLowerCase().replace(/\s+and\s+/g, ' ').replace(/\s+the\s+/g, ' ');
                const normalizedInput = englishName.toLowerCase().replace(/\s+and\s+/g, ' ').replace(/\s+the\s+/g, ' ');
                
                if (normalizedInput.includes(normalizedKey) || normalizedKey.includes(normalizedInput)) {
                    return value;
                }
            }
            
            // 6. è¿”å›åŸåç§°ï¼ˆä½œä¸ºæœ€åæ‰‹æ®µï¼‰
            console.warn(`æœªæ‰¾åˆ°å›½å®¶æ˜ å°„: ${englishName}`);
            return englishName;
        }

        // å¤„ç†ç”µå°æ•°æ® - ä¸¥æ ¼å»é‡
        function processStationsData(stations) {
            // ä¸¥æ ¼å»é‡ - åŸºäº stationuuid
            const uniqueStationsMap = new Map();
            stations.forEach(station => {
                if (station && station.stationuuid) {
                    uniqueStationsMap.set(station.stationuuid, station);
                }
            });
            
            allStations = Array.from(uniqueStationsMap.values()).filter(station => 
                station && (station.url_resolved || station.url)
            );
            
            console.log(`åŸå§‹æ•°æ®: ${stations.length} ä¸ª, å»é‡å: ${allStations.length} ä¸ª`);
            
            updateStats();
            extractFilterOptions();
            
            displayedCount = 0;
            displayedStations = [];
            filteredStations = [...allStations];
            
            loadMoreStations();
            updateMapMarkers(allStations.slice(0, 500));
        }

        // æå–ç­›é€‰é€‰é¡¹
        function extractFilterOptions() {
            extractCountries();
            extractLanguages();
        }

        // æå–å›½å®¶åˆ—è¡¨ - ä¿®å¤ç‰ˆæœ¬
        function extractCountries() {
            const countrySet = new Set();
            allStations.forEach(station => {
                if (station.country) {
                    // å°†è‹±æ–‡å›½å®¶åè½¬æ¢ä¸ºä¸­æ–‡ - ç¡®ä¿è¿™é‡Œæ­£ç¡®è°ƒç”¨
                    const chineseName = getChineseCountryName(station.country);
                    countrySet.add(chineseName);
                }
            });
            
            countries = Array.from(countrySet).sort();
            
            const countryFilter = document.getElementById('country-filter');
            countryFilter.innerHTML = '<option value="">æ‰€æœ‰å›½å®¶</option>';
            
            countries.forEach(country => {
                const option = document.createElement('option');
                option.value = country;
                option.textContent = country;
                countryFilter.appendChild(option);
            });
        }

        // åŠ è½½æ›´å¤šç”µå°
        function loadMoreStations() {
            const startIndex = displayedCount;
            const endIndex = Math.min(displayedCount + 200, filteredStations.length);
            
            if (startIndex >= filteredStations.length) {
                document.getElementById('load-more-btn').style.display = 'none';
                return;
            }
            
            const stationsToAdd = filteredStations.slice(startIndex, endIndex);
            displayedStations = displayedStations.concat(stationsToAdd);
            displayedCount = endIndex;
            
            renderRadioList(displayedStations, document.getElementById('radio-list'), 'all');
            updateStats();
            updateLoadMoreButton();
        }

        // æ›´æ–°åŠ è½½æ›´å¤šæŒ‰é’®
        function updateLoadMoreButton() {
            const loadMoreBtn = document.getElementById('load-more-btn');
            if (displayedCount >= filteredStations.length) {
                loadMoreBtn.style.display = 'none';
            } else {
                loadMoreBtn.style.display = 'block';
                const remaining = filteredStations.length - displayedCount;
                loadMoreBtn.textContent = `åŠ è½½æ›´å¤š (${remaining} ä¸ªç”µå°)`;
            }
        }

        // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
        function updateStats() {
            const totalDisplay = `${allStations.length.toLocaleString()} ç”µå° / ${countries.length} å›½å®¶`;
            document.getElementById('total-stations').textContent = totalDisplay;
            
            const currentDisplayCount = Math.min(displayedCount, filteredStations.length);
            const displayedCountText = `æ˜¾ç¤º: ${currentDisplayCount}/${filteredStations.length}`;
            document.getElementById('filtered-stations').textContent = displayedCountText;
        }

        // æ ¼å¼åŒ–åˆ†ç±»æ˜¾ç¤º
        function formatGenre(genre) {
            const genreLower = genre.toLowerCase();
            if (genreMapping[genreLower]) {
                return genreMapping[genreLower];
            }
            
            // æ¨¡ç³ŠåŒ¹é…
            const fuzzyMap = {
                'oldies': 'ç»å…¸è€æ­Œ', 'top40': 'æµè¡Œé‡‘æ›²', 'hits': 'çƒ­é—¨é‡‘æ›²',
                'rnb': 'èŠ‚å¥è“è°ƒ', 'r&b': 'èŠ‚å¥è“è°ƒ', 'edm': 'ç”µå­èˆæ›²',
                'kpop': 'éŸ©æµéŸ³ä¹', 'jpop': 'æ—¥æµéŸ³ä¹', 'cpop': 'åè¯­æµè¡Œ'
            };
            
            for (const [key, value] of Object.entries(fuzzyMap)) {
                if (genreLower.includes(key)) {
                    return value;
                }
            }
            
            return genre;
        }

        // æ ¼å¼åŒ–æ ‡ç­¾æ˜¾ç¤º
        function formatGenres(tags) {
            if (!tags) return 'æœªåˆ†ç±»';
            
            const genreList = tags.split(',').slice(0, 2).map(genre => {
                return formatGenre(genre.trim());
            });
            
            return genreList.join(' Â· ');
        }

        // æ›´æ–°æ•°æ®æºæ˜¾ç¤º
        function updateDataSource(source, region = 'æ‰€æœ‰åœ°åŒº') {
            const sourceElement = document.getElementById('data-source');
            if (sourceElement) {
                sourceElement.textContent = `æ•°æ®æ¥æº: ${source} | åœ°åŒº: ${region}`;
            }
        }

        // æå–è¯­è¨€åˆ—è¡¨
        function extractLanguages() {
            const languageSet = new Set();
            
            allStations.forEach(station => {
                if (station.language) {
                    const stationLanguages = station.language.split(',').map(lang => lang.trim().toLowerCase());
                    stationLanguages.forEach(lang => {
                        if (lang && languageMapping[lang]) {
                            languageSet.add(languageMapping[lang]);
                        } else if (lang) {
                            // å°†æœªæ˜ å°„çš„è¯­è¨€å½’ç±»ä¸º"å…¶ä»–è¯­è¨€"
                            languageSet.add('å…¶ä»–è¯­è¨€');
                        }
                    });
                }
            });
            
            languages = Array.from(languageSet).sort();
            
            const languageFilter = document.getElementById('language-filter');
            languageFilter.innerHTML = '<option value="">æ‰€æœ‰è¯­è¨€</option>';
            
            languages.forEach(language => {
                const option = document.createElement('option');
                option.value = language;
                option.textContent = language;
                languageFilter.appendChild(option);
            });
        }

        // æ¸²æŸ“ç”µå°åˆ—è¡¨
        function renderRadioList(stations = displayedStations, container = document.getElementById('radio-list'), listType = 'all') {
            if (!container) return;
            
            if (stations.length === 0) {
                if (listType === 'favorites') {
                    container.innerHTML = '<div class="loading">æš‚æ— æ”¶è—çš„ç”µå°</div>';
                } else if (listType === 'history') {
                    container.innerHTML = '<div class="loading">æš‚æ— æ’­æ”¾å†å²</div>';
                } else {
                    container.innerHTML = '<div class="loading">æœªæ‰¾åˆ°åŒ¹é…çš„ç”µå°</div>';
                }
                return;
            }
            
            container.innerHTML = '';
            
            stations.forEach(station => {
                const radioItem = document.createElement('div');
                radioItem.className = 'radio-item';
                if (currentStation && currentStation.stationuuid === station.stationuuid) {
                    radioItem.classList.add('active');
                }
                radioItem.dataset.id = station.stationuuid;
                
                const flagEmoji = getFlagEmoji(station.countrycode);
                const isFavorite = favoriteStations.some(fav => fav.stationuuid === station.stationuuid);
                
                // å°†å›½å®¶åè½¬æ¢ä¸ºä¸­æ–‡æ˜¾ç¤º
                const countryName = getChineseCountryName(station.country);
                
                radioItem.innerHTML = `
                    <button class="favorite-btn ${isFavorite ? 'active' : ''}" data-id="${station.stationuuid}">
                        <i class="fas fa-heart"></i>
                    </button>
                    <div class="radio-flag">${flagEmoji}</div>
                    <div class="radio-info">
                        <div class="radio-name">${station.name || 'æœªçŸ¥ç”µå°'}</div>
                        <div class="radio-country">${countryName || 'æœªçŸ¥å›½å®¶'}</div>
                        <div class="radio-genre">${formatGenres(station.tags)}</div>
                    </div>
                    <button class="play-btn" data-id="${station.stationuuid}">
                        <i class="fas fa-play"></i>
                    </button>
                `;
                
                container.appendChild(radioItem);
            });
            
            attachEventListeners();
        }

        // é™„åŠ äº‹ä»¶ç›‘å¬å™¨
        function attachEventListeners() {
            document.querySelectorAll('.play-btn').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const stationId = this.dataset.id;
                    playStation(stationId);
                });
            });
            
            document.querySelectorAll('.favorite-btn').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const stationId = this.dataset.id;
                    toggleFavorite(stationId);
                });
            });
            
            document.querySelectorAll('.radio-item').forEach(item => {
                item.addEventListener('click', function() {
                    const stationId = this.dataset.id;
                    playStation(stationId);
                });
            });
        }

        // æ’­æ”¾ç”µå°
        function playStation(stationId) {
            const station = allStations.find(s => s.stationuuid === stationId);
            if (!station) return;
            
            currentStation = station;
            document.getElementById('current-station').textContent = station.name || 'æœªçŸ¥ç”µå°';
            
            // å°†å›½å®¶åè½¬æ¢ä¸ºä¸­æ–‡æ˜¾ç¤º
            const countryName = getChineseCountryName(station.country);
            document.getElementById('current-country').textContent = `${countryName || 'æœªçŸ¥å›½å®¶'} â€¢ ${formatGenres(station.tags)}`;
            
            const playPauseBtn = document.getElementById('play-pause-btn');
            playPauseBtn.innerHTML = '<i class="fas fa-pause"></i>';
            isPlaying = true;
            
            addToHistory(station);
            
            // æ›´æ–°ç”µå°åˆ—è¡¨é«˜äº®
            document.querySelectorAll('.radio-item').forEach(item => {
                item.classList.remove('active');
                if (item.dataset.id === stationId) {
                    item.classList.add('active');
                }
            });
            
            // æ£€æµ‹å¹¶æ˜¾ç¤ºéŸ³è´¨ä¿¡æ¯
            detectAndDisplayQuality(station);
            
            // ä¿®å¤åœ°å›¾è·³è½¬é€»è¾‘
            if (station.geo_lat && station.geo_long) {
                // ç¡®ä¿åœ°å›¾è§†å›¾å¹³æ»‘è·³è½¬
                map.setView([station.geo_lat, station.geo_long], 6, {
                    animate: true,
                    duration: 1.0,
                    easeLinearity: 0.25
                });
                
                // é«˜äº®å¯¹åº”çš„åœ°å›¾æ ‡è®°
                markers.forEach(marker => {
                    const markerLat = marker.getLatLng().lat;
                    const markerLng = marker.getLatLng().lng;
                    
                    // ä½¿ç”¨å®¹å·®æ¯”è¾ƒï¼Œé¿å…æµ®ç‚¹æ•°ç²¾åº¦é—®é¢˜
                    const latDiff = Math.abs(markerLat - station.geo_lat);
                    const lngDiff = Math.abs(markerLng - station.geo_long);
                    
                    if (latDiff < 0.001 && lngDiff < 0.001) {
                        marker.openPopup();
                        
                        // æ·»åŠ è§†è§‰åé¦ˆ
                        marker.setIcon(L.divIcon({
                            className: 'pulsing-marker',
                            html: '<div style="background-color: #e52e71; width: 20px; height: 20px; border-radius: 50%; border: 3px solid white; box-shadow: 0 0 10px #e52e71;"></div>',
                            iconSize: [20, 20],
                            iconAnchor: [10, 10]
                        }));
                        
                        // 3ç§’åæ¢å¤åŸæ ·å¼
                        setTimeout(() => {
                            marker.setIcon(new L.Icon.Default());
                        }, 3000);
                    }
                });
            } else {
                console.warn('ç”µå°ç¼ºå°‘ç»çº¬åº¦ä¿¡æ¯:', station.name);
            }
            
            // éŸ³é¢‘æ’­æ”¾é€»è¾‘
            audioPlayer.pause();
            
            const streamUrl = station.url_resolved || station.url;
            if (streamUrl) {
                audioPlayer.src = streamUrl;
                audioPlayer.play().catch(error => {
                    console.error('æ’­æ”¾å¤±è´¥:', error);
                    document.getElementById('current-station').textContent = 'æ’­æ”¾å¤±è´¥ï¼Œè¯·å°è¯•å…¶ä»–ç”µå°';
                    document.getElementById('current-station').style.color = '#e52e71';
                    playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
                    isPlaying = false;
                    
                    setTimeout(() => {
                        if (document.getElementById('current-station')) {
                            document.getElementById('current-station').style.color = '';
                        }
                    }, 3000);
                });
            } else {
                console.error('ç”µå°æ²¡æœ‰æœ‰æ•ˆçš„æµåª’ä½“URL:', station);
            }
            
            // è‡ªåŠ¨æ»šåŠ¨åˆ°å½“å‰æ’­æ”¾çš„ç”µå°
            scrollToCurrentStation(stationId);
        }

        // è‡ªåŠ¨æ»šåŠ¨åˆ°å½“å‰æ’­æ”¾çš„ç”µå°
        function scrollToCurrentStation(stationId) {
            const radioList = document.getElementById('radio-list');
            const currentItem = radioList.querySelector(`[data-id="${stationId}"]`);
            
            if (currentItem) {
                currentItem.scrollIntoView({
                    behavior: 'smooth',
                    block: 'center'
                });
            }
        }

        // æ£€æµ‹å¹¶æ˜¾ç¤ºéŸ³è´¨ä¿¡æ¯
        function detectAndDisplayQuality(station) {
            const qualityIndicator = document.getElementById('quality-indicator');
            let quality = 'æœªçŸ¥';
            
            // ä»æ ‡ç­¾ä¸­æ£€æµ‹éŸ³è´¨ä¿¡æ¯
            if (station.tags) {
                const tags = station.tags.toLowerCase().split(',');
                if (tags.includes('high') || tags.includes('hq') || tags.includes('320')) {
                    quality = 'é«˜éŸ³è´¨';
                } else if (tags.includes('medium') || tags.includes('128')) {
                    quality = 'ä¸­éŸ³è´¨';
                } else if (tags.includes('low') || tags.includes('64')) {
                    quality = 'ä½éŸ³è´¨';
                }
            }
            
            // ä»æ¯”ç‰¹ç‡æ£€æµ‹éŸ³è´¨
            if (station.bitrate) {
                if (station.bitrate >= 256) {
                    quality = 'é«˜éŸ³è´¨';
                } else if (station.bitrate >= 128) {
                    quality = 'ä¸­éŸ³è´¨';
                } else {
                    quality = 'ä½éŸ³è´¨';
                }
            }
            
            qualityIndicator.textContent = `(${quality})`;
        }

        // åˆå§‹åŒ–åœ°å›¾
        function initMap() {
            map = L.map('map').setView([20, 0], 3);
            
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            }).addTo(map);
            
            // æ·»åŠ åœ°å›¾ç‚¹å‡»äº‹ä»¶
            map.on('click', function(e) {
                // æ¸…é™¤ä¹‹å‰çš„é€‰æ‹©
                document.querySelectorAll('.radio-item').forEach(item => {
                    item.classList.remove('active');
                });
                
                // æŸ¥æ‰¾é™„è¿‘çš„ç”µå°
                const nearbyStations = findStationsNearLocation(e.latlng.lat, e.latlng.lng, 500);
                
                if (nearbyStations.length > 0) {
                    // æ›´æ–°ç”µå°åˆ—è¡¨æ˜¾ç¤ºé™„è¿‘çš„ç”µå°
                    filteredStations = nearbyStations;
                    displayedCount = 0;
                    displayedStations = [];
                    
                    if (activeTab === 'all') {
                        loadMoreStations();
                    }
                    
                    // æ›´æ–°å›½å®¶ä¿¡æ¯
                    document.getElementById('selected-country').textContent = 'é™„è¿‘ç”µå°';
                    document.getElementById('country-station-count').textContent = `æ‰¾åˆ° ${nearbyStations.length} ä¸ªç”µå°`;
                    
                    // æ›´æ–°åœ°å›¾æ ‡è®°
                    updateMapMarkers(nearbyStations.slice(0, 200));
                }
            });
        }

        // æŸ¥æ‰¾é™„è¿‘ç”µå°
        function findStationsNearLocation(lat, lng, radiusKm) {
            return allStations.filter(station => {
                if (!station.geo_lat || !station.geo_long) return false;
                
                const distance = calculateDistance(lat, lng, station.geo_lat, station.geo_long);
                return distance <= radiusKm;
            });
        }

        // è®¡ç®—ä¸¤ç‚¹é—´è·ç¦»ï¼ˆå…¬é‡Œï¼‰
        function calculateDistance(lat1, lon1, lat2, lon2) {
            const R = 6371;
            const dLat = (lat2 - lat1) * Math.PI / 180;
            const dLon = (lon2 - lon1) * Math.PI / 180;
            const a = 
                Math.sin(dLat/2) * Math.sin(dLat/2) +
                Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) * 
                Math.sin(dLon/2) * Math.sin(dLon/2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
            return R * c;
        }

        // æ›´æ–°åœ°å›¾æ ‡è®° - ä¼˜åŒ–ç‰ˆæœ¬
        function updateMapMarkers(stations) {
            // æ¸…é™¤ç°æœ‰æ ‡è®°
            markers.forEach(marker => map.removeLayer(marker));
            markers = [];
            
            const displayLimit = 300; // å¢åŠ æ˜¾ç¤ºæ•°é‡é™åˆ¶
            
            // ä½¿ç”¨requestAnimationFrameåˆ†æ‰¹å¤„ç†ï¼Œé¿å…é˜»å¡UI
            const batchSize = 50;
            let index = 0;
            
            function processBatch() {
                const batchEnd = Math.min(index + batchSize, Math.min(stations.length, displayLimit));
                
                for (let i = index; i < batchEnd; i++) {
                    const station = stations[i];
                    if (station.geo_lat && station.geo_long) {
                        const flagEmoji = getFlagEmoji(station.countrycode);
                        const countryName = getChineseCountryName(station.country);
                        
                        const marker = L.marker([station.geo_lat, station.geo_long])
                            .addTo(map)
                            .bindPopup(`
                                <div style="color: black; min-width: 200px;">
                                    <b>${station.name || 'æœªçŸ¥ç”µå°'}</b><br>
                                    ${countryName || ''}<br>
                                    <small>${formatGenres(station.tags)}</small><br>
                                    <button onclick="window.playStationFromMap('${station.stationuuid}')" 
                                            style="background:#e52e71;color:white;border:none;padding:5px 10px;border-radius:5px;cursor:pointer;margin-top:5px;">
                                        æ’­æ”¾
                                    </button>
                                </div>
                            `);
                        
                        // æ·»åŠ ç‚¹å‡»äº‹ä»¶
                        marker.on('click', function() {
                            playStation(station.stationuuid);
                        });
                        
                        markers.push(marker);
                    }
                }
                
                index = batchEnd;
                
                if (index < Math.min(stations.length, displayLimit)) {
                    requestAnimationFrame(processBatch);
                } else {
                    console.log(`æ›´æ–°äº† ${markers.length} ä¸ªåœ°å›¾æ ‡è®°`);
                }
            }
            
            processBatch();
        }

        // ä»åœ°å›¾æ’­æ”¾ç”µå°
        window.playStationFromMap = function(stationId) {
            playStation(stationId);
        };

        // é˜²æŠ–æœç´¢
        function debounceSearch() {
            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(performSearch, 300);
        }

        // æ‰§è¡Œæœç´¢ - ä¼˜åŒ–ç‰ˆæœ¬
        function performSearch() {
            const searchTerm = document.getElementById('search-input').value.toLowerCase();
            const countryFilter = document.getElementById('country-filter').value;
            const languageFilter = document.getElementById('language-filter').value;
            
            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            const radioList = document.getElementById('radio-list');
            radioList.innerHTML = '<div class="loading"><i class="fas fa-spinner fa-spin"></i> æ­£åœ¨æœç´¢ç”µå°...</div>';
            
            // ä½¿ç”¨setTimeoutè®©UIæœ‰æœºä¼šæ›´æ–°
            setTimeout(() => {
                filteredStations = allStations.filter(station => {
                    const matchesSearch = searchTerm === '' || 
                        (station.name && station.name.toLowerCase().includes(searchTerm)) || 
                        (station.country && station.country.toLowerCase().includes(searchTerm)) ||
                        (station.tags && station.tags.toLowerCase().includes(searchTerm));
                    
                    // å›½å®¶ç­›é€‰ - æ”¯æŒä¸­è‹±æ–‡åŒ¹é…
                    let matchesCountry = true;
                    if (countryFilter !== '') {
                        const englishCountryName = Object.keys(countryNameMapping).find(
                            key => countryNameMapping[key] === countryFilter
                        ) || countryFilter;
                        matchesCountry = station.country && (
                            station.country.toLowerCase().includes(englishCountryName.toLowerCase()) ||
                            (getChineseCountryName(station.country) && getChineseCountryName(station.country) === countryFilter)
                        );
                    }
                    
                    let matchesLanguage = true;
                    if (languageFilter !== '') {
                        const englishKeyword = Object.keys(languageMapping).find(key => 
                            languageMapping[key] === languageFilter
                        ) || '';
                        matchesLanguage = station.language && 
                            station.language.toLowerCase().includes(englishKeyword.toLowerCase());
                    }
                    
                    let matchesGenre = true;
                    if (currentGenre !== 'all' && currentGenre !== '') {
                        const englishKeyword = Object.keys(genreMapping).find(key => 
                            genreMapping[key] === currentGenre
                        ) || '';
                        matchesGenre = station.tags && 
                            station.tags.toLowerCase().includes(englishKeyword.toLowerCase());
                    }
                    
                    // ä¿®å¤ï¼šåœ°åŒºç­›é€‰
                    let matchesRegion = true;
                    if (currentRegion !== 'all') {
                        const regionCountriesList = getRegionCountries(currentRegion);
                        matchesRegion = regionCountriesList.some(country => {
                            const chineseCountryName = getChineseCountryName(country);
                            const stationChineseName = getChineseCountryName(station.country);
                            
                            return station.country && (
                                station.country.toLowerCase().includes(country.toLowerCase()) ||
                                stationChineseName.includes(chineseCountryName) ||
                                chineseCountryName.includes(stationChineseName)
                            );
                        });
                    }
                    
                    // éŸ³è´¨ç­›é€‰
                    let matchesQuality = true;
                    if (currentQuality !== 'auto') {
                        if (currentQuality === 'high') {
                            matchesQuality = station.tags && (
                                station.tags.toLowerCase().includes('high') || 
                                station.tags.toLowerCase().includes('hq') ||
                                station.tags.toLowerCase().includes('320')
                            );
                        } else if (currentQuality === 'medium') {
                            matchesQuality = station.tags && (
                                station.tags.toLowerCase().includes('medium') || 
                                station.tags.toLowerCase().includes('128')
                            );
                        } else if (currentQuality === 'low') {
                            matchesQuality = station.tags && (
                                station.tags.toLowerCase().includes('low') || 
                                station.tags.toLowerCase().includes('64')
                            );
                        }
                    }
                    
                    return matchesSearch && matchesCountry && matchesLanguage && matchesGenre && matchesRegion && matchesQuality;
                });
                
                displayedCount = 0;
                displayedStations = [];
                
                if (activeTab === 'all') {
                    loadMoreStations();
                }
                
                // å»¶è¿Ÿæ›´æ–°åœ°å›¾æ ‡è®°ï¼Œé¿å…é˜»å¡UI
                clearTimeout(mapUpdateTimeout);
                mapUpdateTimeout = setTimeout(() => {
                    updateMapMarkers(filteredStations.slice(0, 200));
                }, 100);
                
                updateCountryInfo();
            }, 10);
        }

        // è·å–åœ°åŒºå¯¹åº”çš„å›½å®¶åˆ—è¡¨
        function getRegionCountries(region) {
            return regionCountries[region] || [];
        }

        // æ›´æ–°å›½å®¶ä¿¡æ¯æ˜¾ç¤º
        function updateCountryInfo() {
            const countryName = document.getElementById('selected-country');
            const countryCount = document.getElementById('country-station-count');
            
            if (currentRegion !== 'all') {
                countryName.textContent = `${regionNames[currentRegion]}åœ°åŒºç”µå°`;
                countryCount.textContent = `æ‰¾åˆ° ${filteredStations.length} ä¸ªç”µå°`;
                
                // æ›´æ–°å›½å®¶ç­›é€‰å™¨ä¸ºå½“å‰åœ°åŒºçš„å›½å®¶
                updateCountryFilterForRegion(currentRegion);
            } else if (document.getElementById('country-filter').value) {
                const selectedCountry = document.getElementById('country-filter').value;
                countryName.textContent = `${selectedCountry}ç”µå°`;
                countryCount.textContent = `æ‰¾åˆ° ${filteredStations.length} ä¸ªç”µå°`;
            } else {
                countryName.textContent = 'å…¨çƒç”µå°';
                countryCount.textContent = `ç‚¹å‡»åœ°å›¾ä¸Šçš„æ ‡è®°æˆ–ä½¿ç”¨ç­›é€‰å™¨é€‰æ‹©ç”µå° (${filteredStations.length} ä¸ªç”µå°)`;
                
                // é‡ç½®å›½å®¶ç­›é€‰å™¨ä¸ºæ‰€æœ‰å›½å®¶
                resetCountryFilter();
            }
        }

        // æ›´æ–°å›½å®¶ç­›é€‰å™¨ä¸ºæŒ‡å®šåœ°åŒºçš„å›½å®¶
        function updateCountryFilterForRegion(region) {
            const regionCountriesList = getRegionCountries(region);
            const countryFilter = document.getElementById('country-filter');
            
            // ä¿å­˜å½“å‰é€‰ä¸­çš„å›½å®¶
            const currentSelected = countryFilter.value;
            
            countryFilter.innerHTML = '<option value="">æ‰€æœ‰å›½å®¶</option>';
            
            // è·å–è¯¥åœ°åŒºå›½å®¶çš„ä¸­æ–‡åç§°
            const regionCountryNames = regionCountriesList.map(country => 
                getChineseCountryName(country)
            ).sort();
            
            regionCountryNames.forEach(country => {
                const option = document.createElement('option');
                option.value = country;
                option.textContent = country;
                countryFilter.appendChild(option);
            });
            
            // å¦‚æœä¹‹å‰é€‰ä¸­çš„å›½å®¶åœ¨å½“å‰åœ°åŒºä¸­ï¼Œä¿æŒé€‰ä¸­çŠ¶æ€
            if (regionCountryNames.includes(currentSelected)) {
                countryFilter.value = currentSelected;
            } else {
                countryFilter.value = '';
            }
        }

        // é‡ç½®å›½å®¶ç­›é€‰å™¨ä¸ºæ‰€æœ‰å›½å®¶
        function resetCountryFilter() {
            const countryFilter = document.getElementById('country-filter');
            const currentSelected = countryFilter.value;
            
            countryFilter.innerHTML = '<option value="">æ‰€æœ‰å›½å®¶</option>';
            
            countries.forEach(country => {
                const option = document.createElement('option');
                option.value = country;
                option.textContent = country;
                countryFilter.appendChild(option);
            });
            
            // ä¿æŒä¹‹å‰é€‰ä¸­çš„å›½å®¶
            if (countries.includes(currentSelected)) {
                countryFilter.value = currentSelected;
            }
        }

        // åŠ è½½æœ¬åœ°æ•°æ®
        function loadLocalData() {
            const storedFavorites = localStorage.getItem('radioFavorites');
            const storedHistory = localStorage.getItem('radioHistory');
            
            if (storedFavorites) {
                favoriteStations = JSON.parse(storedFavorites);
            }
            
            if (storedHistory) {
                historyStations = JSON.parse(storedHistory);
            }
        }

        // ä¿å­˜æ•°æ®åˆ°localStorage
        function saveLocalData() {
            localStorage.setItem('radioFavorites', JSON.stringify(favoriteStations));
            localStorage.setItem('radioHistory', JSON.stringify(historyStations));
        }

        // åˆ‡æ¢æ”¶è—çŠ¶æ€
        function toggleFavorite(stationId) {
            const station = allStations.find(s => s.stationuuid === stationId);
            if (!station) return;
            
            const index = favoriteStations.findIndex(fav => fav.stationuuid === stationId);
            
            if (index === -1) {
                favoriteStations.push(station);
            } else {
                favoriteStations.splice(index, 1);
            }
            
            saveLocalData();
            
            if (activeTab === 'all') {
                renderRadioList();
            } else if (activeTab === 'favorites') {
                updateTabs();
            }
        }

        // æ·»åŠ åˆ°æ’­æ”¾å†å²
        function addToHistory(station) {
            const existingIndex = historyStations.findIndex(item => 
                item.station.stationuuid === station.stationuuid
            );
            
            if (existingIndex !== -1) {
                historyStations.splice(existingIndex, 1);
            }
            
            historyStations.push({
                station: station,
                timestamp: Date.now()
            });
            
            if (historyStations.length > 50) {
                historyStations = historyStations.slice(-50);
            }
            
            saveLocalData();
            
            if (activeTab === 'history') {
                updateTabs();
            }
        }

        // æ ¹æ®å›½å®¶ä»£ç è·å–å›½æ——emoji
        function getFlagEmoji(countryCode) {
            if (!countryCode) return 'ğŸŒ';
            
            const codePoints = countryCode
                .toUpperCase()
                .split('')
                .map(char => 127397 + char.charCodeAt());
            return String.fromCodePoint(...codePoints);
        }

        // æ›´æ–°æ ‡ç­¾é¡µå†…å®¹
        function updateTabs() {
            if (activeTab === 'favorites') {
                renderRadioList(favoriteStations, document.getElementById('favorites-list'), 'favorites');
            } else if (activeTab === 'history') {
                renderHistoryList();
            }
        }

        // æ¸²æŸ“å†å²åˆ—è¡¨
        function renderHistoryList() {
            const historyList = document.getElementById('history-list');
            
            if (historyStations.length === 0) {
                historyList.innerHTML = '<div class="loading">æš‚æ— æ’­æ”¾å†å²</div>';
                return;
            }
            
            historyList.innerHTML = '';
            
            const recentHistory = historyStations.slice(-20).reverse();
            
            recentHistory.forEach(item => {
                const historyItem = document.createElement('div');
                historyItem.className = 'history-item';
                historyItem.dataset.id = item.station.stationuuid;
                
                const flagEmoji = getFlagEmoji(item.station.countrycode);
                const timeString = new Date(item.timestamp).toLocaleString();
                const countryName = getChineseCountryName(item.station.country);
                
                historyItem.innerHTML = `
                    <div class="radio-flag">${flagEmoji}</div>
                    <div class="radio-info">
                        <div class="radio-name">${item.station.name || 'æœªçŸ¥ç”µå°'}</div>
                        <div class="radio-country">${countryName || 'æœªçŸ¥å›½å®¶'}</div>
                        <div class="history-time">${timeString}</div>
                    </div>
                    <button class="play-btn" data-id="${item.station.stationuuid}">
                        <i class="fas fa-play"></i>
                    </button>
                `;
                
                historyList.appendChild(historyItem);
            });
            
            attachEventListeners();
        }

        // æ’­æ”¾æ§åˆ¶
        function togglePlayPause() {
            if (!currentStation) {
                if (filteredStations.length > 0) {
                    playStation(filteredStations[0].stationuuid);
                }
                return;
            }
            
            if (isPlaying) {
                document.getElementById('play-pause-btn').innerHTML = '<i class="fas fa-play"></i>';
                audioPlayer.pause();
            } else {
                document.getElementById('play-pause-btn').innerHTML = '<i class="fas fa-pause"></i>';
                audioPlayer.play().catch(error => {
                    console.error('æ’­æ”¾å¤±è´¥:', error);
                    document.getElementById('play-pause-btn').innerHTML = '<i class="fas fa-play"></i>';
                });
            }
            
            isPlaying = !isPlaying;
        }

        function stopPlayback() {
            audioPlayer.pause();
            audioPlayer.currentTime = 0;
            isPlaying = false;
            document.getElementById('play-pause-btn').innerHTML = '<i class="fas fa-play"></i>';
        }

        function updateVolume() {
            audioPlayer.volume = document.querySelector('.volume-slider').value / 100;
        }

        // åˆ†äº«åŠŸèƒ½
        function toggleShareMenu() {
            const shareMenu = document.getElementById('share-menu');
            shareMenu.classList.toggle('active');
        }

        // åˆ†äº«åŠŸèƒ½ - ä¼˜åŒ–ç‰ˆæœ¬
        function shareStation(platform) {
            if (!currentStation) {
                alert('è¯·å…ˆé€‰æ‹©ä¸€ä¸ªç”µå°');
                return;
            }
            
            const stationName = currentStation.name;
            const countryName = getChineseCountryName(currentStation.country);
            const genre = formatGenres(currentStation.tags);
            
            // ç”Ÿæˆå¸¦å‚æ•°çš„åˆ†äº«é“¾æ¥
            const shareUrl = generateShareUrl();
            
            // ä¼˜åŒ–çš„åˆ†äº«æ–‡æœ¬
            const shareText = `ğŸ§ æˆ‘æ­£åœ¨é€šè¿‡å…¨çƒå¹¿æ’­ç”µå°æ”¶å¬ ${stationName} (${countryName}) - ${genre}`;
            const fullShareContent = `${shareText}\n\nğŸ“» ç”µå°æµåª’ä½“åœ°å€: ${shareUrl}\nğŸŒ å‘ç°æ›´å¤šå…¨çƒç”µå°: ${window.location.origin}${window.location.pathname}`;
            
            let shareTargetUrl = '';
            
            switch(platform) {
                case 'copy-link':
                    navigator.clipboard.writeText(fullShareContent).then(() => {
                        showShareSuccess('ç”µå°ä¿¡æ¯å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
                    }).catch(() => {
                        // å¤‡ç”¨æ–¹æ¡ˆ
                        const textArea = document.createElement('textarea');
                        textArea.value = fullShareContent;
                        document.body.appendChild(textArea);
                        textArea.select();
                        document.execCommand('copy');
                        document.body.removeChild(textArea);
                        showShareSuccess('ç”µå°ä¿¡æ¯å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
                    });
                    break;
                case 'wechat':
                    showWechatShareGuide(fullShareContent);
                    break;
                case 'weibo':
                    shareTargetUrl = `https://service.weibo.com/share/share.php?url=${encodeURIComponent(shareUrl)}&title=${encodeURIComponent(shareText)}&pic=&ralateUid=&language=zh_cn`;
                    window.open(shareTargetUrl, '_blank', 'width=600,height=400');
                    showShareSuccess('å·²æ‰“å¼€å¾®åšåˆ†äº«é¡µé¢');
                    break;
                case 'qq':
                    shareTargetUrl = `https://connect.qq.com/widget/shareqq/index.html?url=${encodeURIComponent(shareUrl)}&title=${encodeURIComponent(shareText)}&source=å…¨çƒå¹¿æ’­ç”µå°&desc=${encodeURIComponent(`æ¥è‡ª${countryName}çš„${genre}ç”µå°`)}`;
                    window.open(shareTargetUrl, '_blank', 'width=600,height=400');
                    showShareSuccess('å·²æ‰“å¼€QQåˆ†äº«é¡µé¢');
                    break;
                case 'twitter':
                    shareTargetUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(shareText)}&url=${encodeURIComponent(shareUrl)}&hashtags=å¹¿æ’­ç”µå°,åœ¨çº¿æ”¶å¬`;
                    window.open(shareTargetUrl, '_blank', 'width=600,height=400');
                    showShareSuccess('å·²æ‰“å¼€Twitteråˆ†äº«é¡µé¢');
                    break;
                case 'facebook':
                    shareTargetUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(shareUrl)}&quote=${encodeURIComponent(shareText)}`;
                    window.open(shareTargetUrl, '_blank', 'width=600,height=400');
                    showShareSuccess('å·²æ‰“å¼€Facebookåˆ†äº«é¡µé¢');
                    break;
            }
            
            // å…³é—­åˆ†äº«èœå•
            document.getElementById('share-menu').classList.remove('active');
        }

        // ç”Ÿæˆåˆ†äº«é“¾æ¥
        function generateShareUrl() {
            if (!currentStation) return window.location.href;
            return `${window.location.origin}${window.location.pathname}?station=${currentStation.stationuuid}`;
        }

        // æ˜¾ç¤ºå¾®ä¿¡åˆ†äº«æŒ‡å¼•
        function showWechatShareGuide(content) {
            const modal = document.createElement('div');
            modal.className = 'wechat-share-guide';
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.8);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 1003;
            `;
            
            const guideBox = document.createElement('div');
            guideBox.style.cssText = `
                background: rgba(255, 255, 255, 0.1);
                backdrop-filter: blur(10px);
                border-radius: 15px;
                padding: 20px;
                max-width: 400px;
                width: 90%;
                text-align: center;
                border: 1px solid rgba(255, 255, 255, 0.2);
            `;
            
            guideBox.innerHTML = `
                <div style="margin-bottom: 15px;">
                    <i class="fab fa-weixin" style="font-size: 3rem; color: #09BB07;"></i>
                </div>
                <h3 style="color: #ff8a00; margin-bottom: 15px;">å¾®ä¿¡åˆ†äº«æŒ‡å¼•</h3>
                <p style="margin-bottom: 15px; line-height: 1.5;">
                    è¯·å¤åˆ¶ä»¥ä¸‹å†…å®¹ï¼Œç„¶ååœ¨å¾®ä¿¡ä¸­ç²˜è´´åˆ†äº«ç»™æœ‹å‹ï¼š
                </p>
                <div style="background: rgba(0, 0, 0, 0.3); padding: 10px; border-radius: 5px; margin-bottom: 15px; text-align: left;">
                    <pre style="white-space: pre-wrap; font-family: monospace; font-size: 0.8rem; margin: 0; color: white;">${content}</pre>
                </div>
                <button id="copy-wechat-btn" style="background: #09BB07; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; width: 100%;">
                    <i class="fas fa-copy"></i> å¤åˆ¶å†…å®¹
                </button>
                <button id="close-wechat-btn" style="background: none; color: #aaa; border: none; padding: 10px; cursor: pointer; width: 100%; margin-top: 10px;">
                    å–æ¶ˆ
                </button>
            `;
            
            modal.appendChild(guideBox);
            document.body.appendChild(modal);
            
            // äº‹ä»¶ç›‘å¬
            modal.querySelector('#copy-wechat-btn').addEventListener('click', () => {
                navigator.clipboard.writeText(content).then(() => {
                    showShareSuccess('å†…å®¹å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
                    modal.remove();
                });
            });
            
            modal.querySelector('#close-wechat-btn').addEventListener('click', () => modal.remove());
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.remove();
                }
            });
        }

        // æ˜¾ç¤ºåˆ†äº«æˆåŠŸæç¤º
        function showShareSuccess(message) {
            // ç§»é™¤å¯èƒ½å·²å­˜åœ¨çš„æç¤º
            const existingSuccess = document.querySelector('.share-success');
            if (existingSuccess) {
                existingSuccess.remove();
            }
            
            const successElement = document.createElement('div');
            successElement.className = 'share-success';
            successElement.innerHTML = `
                <i class="fas fa-check-circle"></i>
                <span>${message}</span>
            `;
            
            document.body.appendChild(successElement);
            
            // 3ç§’åè‡ªåŠ¨ç§»é™¤
            setTimeout(() => {
                if (successElement.parentNode) {
                    successElement.remove();
                }
            }, 3000);
        }

        // æ£€æŸ¥URLå‚æ•°å¹¶è‡ªåŠ¨æ’­æ”¾ç”µå°
        function checkUrlParams() {
            const urlParams = new URLSearchParams(window.location.search);
            const stationId = urlParams.get('station');
            
            if (stationId) {
                console.log(`æ£€æµ‹åˆ°åˆ†äº«é“¾æ¥ï¼Œå°è¯•æ’­æ”¾ç”µå°: ${stationId}`);
                
                // å»¶è¿Ÿæ‰§è¡Œï¼Œç¡®ä¿ç”µå°æ•°æ®å·²åŠ è½½
                setTimeout(() => {
                    const station = allStations.find(s => s.stationuuid === stationId);
                    if (station) {
                        // æ˜¾ç¤ºæ¬¢è¿æç¤º
                        showWelcomeNotification(station);
                        
                        // è‡ªåŠ¨æ’­æ”¾ç”µå°
                        playStation(stationId);
                        
                        // æ»šåŠ¨åˆ°è¯¥ç”µå°ä½ç½®
                        scrollToStation(stationId);
                    } else {
                        console.warn(`æœªæ‰¾åˆ°IDä¸º ${stationId} çš„ç”µå°`);
                    }
                }, 1000);
            }
        }

        // æ˜¾ç¤ºæ¬¢è¿æç¤º
        function showWelcomeNotification(station) {
            // ç§»é™¤å¯èƒ½å·²å­˜åœ¨çš„é€šçŸ¥
            const existingNotification = document.querySelector('.welcome-notification');
            if (existingNotification) {
                existingNotification.remove();
            }
            
            const countryName = getChineseCountryName(station.country);
            const genre = formatGenres(station.tags);
            const notification = document.createElement('div');
            notification.className = 'welcome-notification';
            notification.innerHTML = `
                <i class="fas fa-broadcast-tower"></i>
                <div class="welcome-content">
                    <div class="welcome-title">æ¬¢è¿æ”¶å¬æœ‹å‹åˆ†äº«çš„ç”µå°</div>
                    <div class="welcome-details">
                        ${station.name} Â· ${countryName} Â· ${genre}
                    </div>
                </div>
                <button class="close-btn"><i class="fas fa-times"></i></button>
            `;
            
            document.body.appendChild(notification);
            
            // æ·»åŠ å…³é—­æŒ‰é’®äº‹ä»¶
            notification.querySelector('.close-btn').addEventListener('click', function() {
                notification.remove();
            });
            
            // 8ç§’åè‡ªåŠ¨å…³é—­
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
            }, 8000);
        }

        // æ»šåŠ¨åˆ°æŒ‡å®šç”µå°
        function scrollToStation(stationId) {
            const radioList = document.getElementById('radio-list');
            const stationElement = radioList.querySelector(`[data-id="${stationId}"]`);
            
            if (stationElement) {
                stationElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
                
                // æ·»åŠ é«˜äº®æ•ˆæœ
                stationElement.style.backgroundColor = 'rgba(255, 138, 0, 0.2)';
                stationElement.style.borderColor = 'rgba(255, 138, 0, 0.5)';
                
                setTimeout(() => {
                    stationElement.style.backgroundColor = '';
                    stationElement.style.borderColor = '';
                }, 3000);
            }
        }

        // è‡ªå®šä¹‰ä¸‹æ‹‰èœå•åŠŸèƒ½ - ä¼˜åŒ–ç‰ˆæœ¬
        function initCustomSelect() {
            const customSelect = document.getElementById('genre-select');
            
            // é‡æ–°æ„å»ºä¸‹æ‹‰èœå•HTML
            customSelect.innerHTML = `
                <div class="select-selected" style="font-weight: bold; color: #ff8a00;">æ‰€æœ‰åˆ†ç±»</div>
                <div class="select-items">
                    <!-- é¡¶éƒ¨ï¼šæ‰€æœ‰åˆ†ç±»é€‰é¡¹ -->
                    <div class="select-header">
                        <div class="select-item active" data-value="all" style="background: rgba(255, 138, 0, 0.2); font-weight: bold;">
                            <i class="fas fa-globe"></i> æ‰€æœ‰åˆ†ç±»
                        </div>
                    </div>
                    
                    <!-- çƒ­é—¨åˆ†ç±» -->
                    <div class="select-category">
                        <div class="category-title">
                            <i class="fas fa-fire"></i> çƒ­é—¨åˆ†ç±»
                        </div>
                        <div class="select-hot-grid">
                            <div class="select-item hot-genre" data-value="æµè¡ŒéŸ³ä¹">æµè¡ŒéŸ³ä¹</div>
                            <div class="select-item hot-genre" data-value="æ–°é—»èµ„è®¯">æ–°é—»èµ„è®¯</div>
                            <div class="select-item hot-genre" data-value="æ‘‡æ»šéŸ³ä¹">æ‘‡æ»šéŸ³ä¹</div>
                            <div class="select-item hot-genre" data-value="è°ˆè¯èŠ‚ç›®">è°ˆè¯èŠ‚ç›®</div>
                            <div class="select-item hot-genre" data-value="å¤å…¸éŸ³ä¹">å¤å…¸éŸ³ä¹</div>
                            <div class="select-item hot-genre" data-value="ä½“è‚²èŠ‚ç›®">ä½“è‚²èŠ‚ç›®</div>
                        </div>
                    </div>
                    
                    <!-- é‡æ–°åˆ†ç±»çš„åˆ†ç±» -->
                    <div class="select-columns">
                        <!-- ç¬¬ä¸€åˆ—ï¼šéŸ³ä¹åˆ†ç±» -->
                        <div class="select-category">
                            <div class="category-title">
                                <i class="fas fa-music"></i> éŸ³ä¹åˆ†ç±»
                            </div>
                            <div class="select-item" data-value="æµè¡ŒéŸ³ä¹">æµè¡ŒéŸ³ä¹</div>
                            <div class="select-item" data-value="æ‘‡æ»šéŸ³ä¹">æ‘‡æ»šéŸ³ä¹</div>
                            <div class="select-item" data-value="å¤å…¸éŸ³ä¹">å¤å…¸éŸ³ä¹</div>
                            <div class="select-item" data-value="çˆµå£«éŸ³ä¹">çˆµå£«éŸ³ä¹</div>
                            <div class="select-item" data-value="ç”µå­éŸ³ä¹">ç”µå­éŸ³ä¹</div>
                            <div class="select-item" data-value="ä¹¡æ‘éŸ³ä¹">ä¹¡æ‘éŸ³ä¹</div>
                            <div class="select-item" data-value="æ°‘è°£éŸ³ä¹">æ°‘è°£éŸ³ä¹</div>
                            <div class="select-item" data-value="è“è°ƒéŸ³ä¹">è“è°ƒéŸ³ä¹</div>
                            <div class="select-item" data-value="å˜»å“ˆéŸ³ä¹">å˜»å“ˆéŸ³ä¹</div>
                            <div class="select-item" data-value="ä¸–ç•ŒéŸ³ä¹">ä¸–ç•ŒéŸ³ä¹</div>
                        </div>
                        
                        <!-- ç¬¬äºŒåˆ—ï¼šèµ„è®¯èŠ‚ç›® -->
                        <div class="select-category">
                            <div class="category-title">
                                <i class="fas fa-newspaper"></i> èµ„è®¯èŠ‚ç›®
                            </div>
                            <div class="select-item" data-value="æ–°é—»èµ„è®¯">æ–°é—»èµ„è®¯</div>
                            <div class="select-item" data-value="è°ˆè¯èŠ‚ç›®">è°ˆè¯èŠ‚ç›®</div>
                            <div class="select-item" data-value="ä½“è‚²èŠ‚ç›®">ä½“è‚²èŠ‚ç›®</div>
                            <div class="select-item" data-value="è´¢ç»èŠ‚ç›®">è´¢ç»èŠ‚ç›®</div>
                            <div class="select-item" data-value="æ”¿æ²»èŠ‚ç›®">æ”¿æ²»èŠ‚ç›®</div>
                            <div class="select-item" data-value="æ—¶äº‹è¯„è®º">æ—¶äº‹è¯„è®º</div>
                            <div class="select-item" data-value="å¤©æ°”é¢„æŠ¥">å¤©æ°”é¢„æŠ¥</div>
                            <div class="select-item" data-value="äº¤é€šä¿¡æ¯">äº¤é€šä¿¡æ¯</div>
                        </div>
                        
                        <!-- ç¬¬ä¸‰åˆ—ï¼šå…¶ä»–åˆ†ç±» -->
                        <div class="select-category">
                            <div class="category-title">
                                <i class="fas fa-star"></i> å…¶ä»–åˆ†ç±»
                            </div>
                            <div class="select-item" data-value="æ•™è‚²èŠ‚ç›®">æ•™è‚²èŠ‚ç›®</div>
                            <div class="select-item" data-value="æ–‡åŒ–èŠ‚ç›®">æ–‡åŒ–èŠ‚ç›®</div>
                            <div class="select-item" data-value="å®—æ•™èŠ‚ç›®">å®—æ•™èŠ‚ç›®</div>
                            <div class="select-item" data-value="å¨±ä¹èŠ‚ç›®">å¨±ä¹èŠ‚ç›®</div>
                            <div class="select-item" data-value="å–œå‰§èŠ‚ç›®">å–œå‰§èŠ‚ç›®</div>
                            <div class="select-item" data-value="ç”Ÿæ´»èŠ‚ç›®">ç”Ÿæ´»èŠ‚ç›®</div>
                            <div class="select-item" data-value="å¥åº·èŠ‚ç›®">å¥åº·èŠ‚ç›®</div>
                            <div class="select-item" data-value="å„¿ç«¥èŠ‚ç›®">å„¿ç«¥èŠ‚ç›®</div>
                        </div>
                    </div>
                </div>
            `;
            
            // å…¶ä½™äº‹ä»¶ç›‘å¬ä»£ç ä¿æŒä¸å˜...
            const selectSelected = customSelect.querySelector('.select-selected');
            const selectItems = customSelect.querySelector('.select-items');
            const selectItemsAll = customSelect.querySelectorAll('.select-item');
            
            selectSelected.addEventListener('click', function(e) {
                e.stopPropagation();
                selectItems.classList.toggle('active');
                this.classList.toggle('select-arrow-active');
            });
            
            selectItemsAll.forEach(item => {
                item.addEventListener('click', function() {
                    selectItemsAll.forEach(i => i.classList.remove('active'));
                    this.classList.add('active');
                    
                    selectSelected.textContent = this.textContent;
                    if (this.dataset.value === 'all') {
                        selectSelected.style.fontWeight = 'bold';
                        selectSelected.style.color = '#ff8a00';
                    } else {
                        selectSelected.style.fontWeight = '';
                        selectSelected.style.color = 'white';
                    }
                    
                    currentGenre = this.dataset.value;
                    selectItems.classList.remove('active');
                    selectSelected.classList.remove('select-arrow-active');
                    performSearch();
                });
            });
            
            document.addEventListener('click', function() {
                selectItems.classList.remove('active');
                selectSelected.classList.remove('select-arrow-active');
            });
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initMap();
            loadLocalData();
            initCustomSelect();
            
            // åˆå§‹åŠ è½½æ‰€æœ‰åœ°åŒºæ•°æ®
            loadPreprocessedData();
            
            // æ£€æŸ¥URLå‚æ•°å¹¶è‡ªåŠ¨æ’­æ”¾ç”µå°
            checkUrlParams();
            
            // äº‹ä»¶ç›‘å¬å™¨
            document.getElementById('search-input').addEventListener('input', debounceSearch);
            document.getElementById('country-filter').addEventListener('change', performSearch);
            document.getElementById('language-filter').addEventListener('change', performSearch);
            document.getElementById('load-more-btn').addEventListener('click', loadMoreStations);

            // åœ°åŒºé€‰æ‹©è”åŠ¨ - ä¿®æ”¹ä¸ºåŠ è½½å¯¹åº”åœ°åŒºæ•°æ®
            document.querySelectorAll('.region-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.region-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentRegion = this.dataset.region;
                    
                    // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
                    const radioList = document.getElementById('radio-list');
                    radioList.innerHTML = '<div class="loading"><i class="fas fa-spinner fa-spin"></i> æ­£åœ¨åŠ è½½åœ°åŒºæ•°æ®...</div>';
                    
                    // å»¶è¿ŸåŠ è½½ä»¥é¿å…UIé˜»å¡
                    setTimeout(async () => {
                        await loadRegionData(currentRegion);
                        performSearch(); // é‡æ–°åº”ç”¨æœç´¢ç­›é€‰
                        updateCountryInfo();
                    }, 10);
                });
            });

            // éŸ³è´¨é€‰æ‹©
            document.getElementById('quality-select').addEventListener('change', function() {
                currentQuality = this.value;
                performSearch();
            });

            // åˆ†äº«åŠŸèƒ½
            document.getElementById('share-btn').addEventListener('click', toggleShareMenu);
            document.querySelectorAll('.share-option').forEach(option => {
                option.addEventListener('click', function(e) {
                    e.preventDefault();
                    const platform = this.dataset.platform;
                    shareStation(platform);
                });
            });

            // ç‚¹å‡»å…¶ä»–åœ°æ–¹å…³é—­åˆ†äº«èœå•
            document.addEventListener('click', function(e) {
                if (!e.target.closest('.share-container')) {
                    document.getElementById('share-menu').classList.remove('active');
                }
            });

            // æ ‡ç­¾é¡µåˆ‡æ¢
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    
                    this.classList.add('active');
                    const tabId = this.dataset.tab;
                    document.getElementById(`${tabId}-stations`).classList.add('active');
                    
                    activeTab = tabId;
                    updateTabs();
                });
            });

            // æ’­æ”¾æ§åˆ¶
            document.getElementById('play-pause-btn').addEventListener('click', togglePlayPause);
            document.getElementById('stop-btn').addEventListener('click', stopPlayback);
            document.querySelector('.volume-slider').addEventListener('input', updateVolume);
        });
    </script>
</body>
</html>
