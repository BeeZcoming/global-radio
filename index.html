<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…¨çƒå¹¿æ’­ç”µå°åœ¨çº¿æ”¶å¬</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            color: #fff;
            min-height: 100vh;
            overflow-x: hidden;
            padding-bottom: 120px;
        }

        .container {
            display: flex;
            max-width: 1800px;
            margin: 0 auto;
            padding: 20px;
            gap: 20px;
        }

        header {
            text-align: center;
            padding: 20px 0;
            background: rgba(0, 0, 0, 0.3);
            margin-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(90deg, #ff8a00, #e52e71);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 0 10px rgba(229, 46, 113, 0.5);
        }

        .tagline {
            font-size: 1.1rem;
            color: #aaa;
            margin-bottom: 10px;
        }

        .search-container {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .search-box {
            flex: 1;
            min-width: 250px;
            position: relative;
        }

        .search-box input {
            width: 100%;
            padding: 12px 20px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 30px;
            color: white;
            font-size: 1rem;
            outline: none;
            transition: all 0.3s;
        }

        .search-box input:focus {
            border-color: #e52e71;
            box-shadow: 0 0 10px rgba(229, 46, 113, 0.5);
        }

        .search-box i {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: #aaa;
        }

        .filter-container {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }

        select {
            padding: 10px 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 30px;
            color: white;
            font-size: 0.9rem;
            outline: none;
            cursor: pointer;
            transition: all 0.3s;
            flex: 1;
            min-width: 120px;
        }

        select:focus {
            border-color: #ff8a00;
            box-shadow: 0 0 10px rgba(255, 138, 0, 0.5);
        }

        option {
            background: #302b63;
        }

        .custom-select {
            position: relative;
            flex: 1;
            min-width: 120px;
        }

        .select-selected {
            padding: 10px 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 30px;
            color: white;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .select-selected:after {
            content: "â–¼";
            font-size: 0.7rem;
            transition: all 0.3s;
        }

        .select-selected.select-arrow-active:after {
            transform: rotate(180deg);
        }

        .select-selected:hover {
            border-color: #ff8a00;
        }

        .select-items {
            position: absolute;
            background: rgba(0, 0, 0, 0.9);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            top: 100%;
            left: 0;
            right: 0;
            z-index: 99;
            max-height: 500px;
            overflow-y: auto;
            display: none;
            padding: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        .select-items.active {
            display: block;
        }

        .select-header {
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 10px;
            padding-bottom: 8px;
        }

        .select-header .select-item {
            background: rgba(255, 138, 0, 0.15) !important;
            border: 1px solid rgba(255, 138, 0, 0.3) !important;
            font-weight: 600;
            margin-bottom: 5px;
            padding: 10px 12px;
        }

        .select-hot-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 6px;
            margin-bottom: 15px;
        }

        .select-hot-grid .select-item {
            background: rgba(229, 46, 113, 0.1);
            border: 1px solid rgba(229, 46, 113, 0.2);
            text-align: center;
            padding: 8px 4px;
            font-size: 0.8rem;
            border-radius: 6px;
        }

        .select-hot-grid .select-item:hover {
            background: rgba(229, 46, 113, 0.2);
            transform: translateY(-1px);
        }

        .select-columns {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }

        .select-category {
            margin-bottom: 0;
        }

        .category-title {
            font-size: 0.85rem;
            color: #ff8a00;
            margin-bottom: 8px;
            padding-bottom: 5px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .select-item {
            padding: 4px 5px;
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.3s;
            font-size: 0.8rem;
            color: #ddd;
            margin-bottom: 0px;
        }

        .select-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(3px);
        }

        .select-item.active {
            background: rgba(255, 138, 0, 0.2);
            color: #ff8a00;
            font-weight: 500;
        }

        .hot-genre::after {
            content: " ğŸ”¥";
            font-size: 0.7rem;
        }

        .sidebar {
            flex: 0 0 350px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 10px 20px 0px 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            max-height: calc(100vh - 200px);
            overflow: hidden;
        }

        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .map-container {
            flex: 1;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 10px 20px 20px 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
        }

        .section-title {
            font-size: 1.3rem;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            color: #ff8a00;
        }

        .radio-list {
            flex: 1;
            overflow-y: auto;
            margin-top: 10px;
        }

        .radio-item {
            display: flex;
            align-items: center;
            padding: 8px 12px;
            margin-bottom: 6px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            transition: all 0.3s;
            cursor: pointer;
            border: 1px solid transparent;
        }

        .radio-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            border-color: rgba(255, 138, 0, 0.3);
        }

        .radio-item.active {
            background: rgba(229, 46, 113, 0.2);
            border-color: rgba(229, 46, 113, 0.5);
        }

        .radio-flag {
            width: 30px;
            height: 20px;
            border-radius: 3px;
            margin-right: 10px;
            font-size: 1.2rem;
            text-align: center;
        }

        .radio-info {
            flex: 1;
            min-width: 0;
        }

        .radio-name {
            font-weight: 600;
            margin-bottom: 3px;
            font-size: 0.9rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .radio-country, .radio-genre {
            font-size: 0.75rem;
            color: #aaa;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .play-btn {
            background: #e52e71;
            color: white;
            border: none;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            flex-shrink: 0;
        }

        .play-btn:hover {
            background: #ff8a00;
            transform: scale(1.1);
        }

        #map {
            flex: 1;
            width: 100%;
            height: 100%;
            min-height: 500px;
            border-radius: 10px;
            overflow: hidden;
        }

        .country-info {
            margin-top: 20px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }

        .country-name {
            font-size: 1.2rem;
            color: #ff8a00;
            margin-bottom: 10px;
        }

        .player {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            padding: 15px 30px;
            display: flex;
            align-items: center;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            z-index: 1000;
        }

        .player-info {
            flex: 1;
            margin-left: 20px;
        }

        .player-station {
            font-weight: 600;
            font-size: 1.1rem;
            margin-bottom: 5px;
        }

        .player-country {
            color: #aaa;
            font-size: 0.9rem;
        }

        .player-controls {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .control-btn {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .control-btn:hover {
            color: #ff8a00;
        }

        .play-pause {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: #e52e71;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .play-pause:hover {
            background: #ff8a00;
        }

        .volume-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .volume-slider {
            width: 100px;
        }

        .quality-container {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-left: 10px;
        }

        .quality-select {
            padding: 5px 10px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            color: white;
            font-size: 0.8rem;
            outline: none;
            cursor: pointer;
            transition: all 0.3s;
        }

        .quality-select:focus {
            border-color: #ff8a00;
        }

        .quality-indicator {
            font-size: 0.7rem;
            color: #aaa;
            margin-left: 5px;
        }

        .now-playing {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-right: 20px;
            padding: 10px 15px;
            background: rgba(255, 138, 0, 0.2);
            border-radius: 30px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 138, 0, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(255, 138, 0, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 138, 0, 0); }
        }

        .now-playing i {
            color: #ff8a00;
        }

        .loading {
            text-align: center;
            padding: 20px;
            color: #aaa;
        }

        .error {
            text-align: center;
            padding: 20px;
            color: #e52e71;
        }

        .stats {
            display: flex;
            justify-content: space-between;
            margin: 10px 0;
            font-size: 0.8rem;
            color: #aaa;
        }

        .favorite-btn {
            background: none;
            border: none;
            color: #aaa;
            font-size: 1rem;
            cursor: pointer;
            margin-right: 8px;
            transition: all 0.3s;
            flex-shrink: 0;
        }

        .favorite-btn.active {
            color: #ff8a00;
        }

        .tabs {
            display: flex;
            margin-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .tab {
            padding: 8px 15px;
            cursor: pointer;
            transition: all 0.3s;
            border-bottom: 2px solid transparent;
            font-size: 0.9rem;
        }

        .tab.active {
            color: #ff8a00;
            border-bottom: 2px solid #ff8a00;
        }

        .tab:hover {
            color: #ff8a00;
        }

        .tab-content {
            display: none;
            flex: 1;
            overflow-y: auto;
        }

        .tab-content.active {
            display: flex;
            flex-direction: column;
        }

        .history-item {
            display: flex;
            align-items: center;
            padding: 8px;
            margin-bottom: 6px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            transition: all 0.3s;
            cursor: pointer;
        }

        .history-item:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .history-time {
            font-size: 0.65rem;
            color: #aaa;
            margin-top: 2px;
        }

        .share-btn {
            background: none;
            border: none;
            color: #aaa;
            font-size: 1.2rem;
            cursor: pointer;
            margin-right: 10px;
            transition: all 0.3s;
            position: relative;
        }

        .share-btn:hover {
            color: #2196F3;
        }

        .share-menu {
            position: absolute;
            bottom: 100%;
            right: 0;
            background: rgba(0, 0, 0, 0.9);
            border-radius: 10px;
            padding: 10px;
            display: none;
            flex-direction: column;
            gap: 8px;
            min-width: 150px;
            z-index: 1001;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .share-menu.active {
            display: flex;
        }

        .share-option {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            color: white;
            text-decoration: none;
        }

        .share-option:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .share-option i {
            width: 20px;
            text-align: center;
        }

        .load-more {
            text-align: center;
            padding: 15px 10px 25px 10px;
            margin-top: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
        }

        .load-more-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
        }

        .load-more-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: #ff8a00;
            transform: translateY(-2px);
        }

        .region-selector {
            display: flex;
            gap: 5px;
            margin-bottom: 10px;
        }

        .region-btn {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: #aaa;
            padding: 6px 8px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.75rem;
            flex: 1;
            text-align: center;
        }

        .region-btn.active {
            background: rgba(255, 138, 0, 0.2);
            color: #ff8a00;
            border-color: rgba(255, 138, 0, 0.5);
        }

        .region-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .data-source-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 5px;
            padding: 8px 0;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .data-source {
            font-size: 0.7rem;
            color: #aaa;
            text-align: right;
            flex: 1;
        }

        .pulsing-marker {
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.2); opacity: 0.7; }
            100% { transform: scale(1); opacity: 1; }
        }

        .welcome-notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255, 138, 0, 0.9);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            z-index: 1002;
            display: flex;
            align-items: center;
            gap: 10px;
            animation: slideDown 0.5s ease-out;
            max-width: 500px;
            width: 90%;
        }

        @keyframes slideDown {
            from { top: -100px; opacity: 0; }
            to { top: 20px; opacity: 1; }
        }

        .welcome-notification .close-btn {
            background: none;
            border: none;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            margin-left: auto;
        }

        .welcome-content {
            flex: 1;
        }

        .welcome-title {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .welcome-details {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .share-success {
            position: fixed;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(33, 150, 243, 0.9);
            color: white;
            padding: 10px 20px;
            border-radius: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            z-index: 1002;
            display: flex;
            align-items: center;
            gap: 10px;
            animation: fadeInOut 3s ease-in-out;
        }

        @keyframes fadeInOut {
            0% { opacity: 0; transform: translateX(-50%) translateY(20px); }
            20% { opacity: 1; transform: translateX(-50%) translateY(0); }
            80% { opacity: 1; transform: translateX(-50%) translateY(0); }
            100% { opacity: 0; transform: translateX(-50%) translateY(-20px); }
        }

        .wechat-share-guide {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1003;
        }

        .wechat-share-guide > div {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            max-width: 400px;
            width: 90%;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .loading-progress {
            padding: 10px;
            margin: 10px 0;
            display: none;
        }
        
        .progress-bar {
            width: 100%;
            height: 4px;
            background: rgba(255,255,255,0.1);
            border-radius: 2px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff8a00, #e52e71);
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .progress-text {
            text-align: center;
            font-size: 0.8rem;
            color: #aaa;
            margin-top: 5px;
        }

        /* ç§»åŠ¨ç«¯ä¼˜åŒ– */
        @media (max-width: 1200px) {
            .container {
                flex-direction: column;
            }
            
            .sidebar {
                flex: 1;
                max-height: 60vh;
                min-height: 500px;
            }
            
            .radio-list {
                max-height: 45vh;
                min-height: 350px;
            }
            
            .map-container {
                min-height: 40vh;
                flex: 0 0 auto;
            }
            
            .select-columns {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .search-container {
                flex-direction: column;
            }
            
            .search-box {
                min-width: 100%;
            }
            
            .player {
                flex-direction: column;
                gap: 15px;
                padding: 15px;
            }
            
            .player-controls {
                width: 100%;
                justify-content: center;
            }
            
            .sidebar {
                flex: 0 0 auto;
                max-height: 65vh !important;
                min-height: 450px !important;
                padding: 8px 15px 5px 15px;
            }
            
            .radio-list {
                max-height: 50vh !important;
                min-height: 380px !important;
                flex: 1;
            }
            
            body {
                padding-bottom: 160px;
            }

            .region-selector {
                flex-wrap: wrap;
                margin-bottom: 8px;
            }

            .region-btn {
                flex: 0 0 calc(33.333% - 5px);
                font-size: 0.7rem;
                padding: 5px 4px;
            }

            .select-columns {
                grid-template-columns: 1fr;
            }
            
            .select-hot-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .welcome-notification {
                top: 10px;
                left: 10px;
                right: 10px;
                transform: none;
                max-width: none;
            }
            
            .radio-item {
                padding: 6px 8px;
                margin-bottom: 4px;
                min-height: 50px;
            }
            
            .radio-flag {
                width: 25px;
                height: 18px;
                margin-right: 8px;
                font-size: 1rem;
            }
            
            .radio-name {
                font-size: 0.85rem;
                line-height: 1.2;
            }
            
            .radio-country, .radio-genre {
                font-size: 0.7rem;
                line-height: 1.1;
            }
            
            .play-btn {
                width: 30px;
                height: 30px;
                font-size: 0.8rem;
            }
            
            .favorite-btn {
                margin-right: 5px;
                font-size: 0.9rem;
            }
            
            .search-container {
                margin-bottom: 10px;
            }
            
            .filter-container {
                margin-bottom: 8px;
                gap: 5px;
                flex-wrap: nowrap;
                overflow-x: auto;
                padding-bottom: 5px;
                -webkit-overflow-scrolling: touch;
            }
            
            .filter-container select,
            .custom-select {
                flex: 0 0 auto;
                min-width: 110px;
                font-size: 0.8rem;
            }
            
            .stats {
                margin: 5px 0;
                font-size: 0.7rem;
            }
            
            .tabs {
                margin-bottom: 8px;
            }
            
            .section-title {
                font-size: 1.1rem;
                margin-bottom: 10px;
            }
            
            .now-playing {
                display: none;
            }
            
            .load-more {
                padding: 10px 5px 15px 5px;
                margin-top: 5px;
            }
        }

        @media (max-width: 480px) {
            .sidebar {
                max-height: 70vh !important;
                min-height: 500px !important;
            }
            
            .radio-list {
                max-height: 55vh !important;
                min-height: 420px !important;
            }
            
            .map-container {
                min-height: 35vh;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .tagline {
                font-size: 0.9rem;
            }
            
            .player-info {
                margin-left: 0;
                text-align: center;
            }
            
            .quality-container {
                margin-left: 0;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1><i class="fas fa-globe-americas"></i> å…¨çƒå¹¿æ’­ç”µå°</h1>
        <p class="tagline">æ¢ç´¢ä¸–ç•Œå„åœ°çš„å¹¿æ’­ç”µå°ï¼Œéšæ—¶æ”¶å¬å…¨çƒå£°éŸ³</p>
    </header>

    <div class="container">
        <div class="sidebar">
            <h2 class="section-title">ç”µå°åˆ—è¡¨</h2>
            
            <div class="search-container">
                <div class="search-box">
                    <input type="text" id="search-input" placeholder="æœç´¢ç”µå°åç§°ã€å›½å®¶æˆ–ç”µå°åˆ†ç±»...ï¼ˆé¦–æ¬¡æœç´¢å¯èƒ½éœ€è¦åŠ è½½æ•°æ®ï¼‰">
                    <i class="fas fa-search"></i>
                </div>
            </div>
            
            <div class="region-selector">
                <button class="region-btn active" data-region="all">å…¨éƒ¨</button>
                <button class="region-btn" data-region="asia">äºšæ´²</button>
                <button class="region-btn" data-region="europe">æ¬§æ´²</button>
                <button class="region-btn" data-region="north-america">åŒ—ç¾æ´²</button>
                <button class="region-btn" data-region="south-america">å—ç¾æ´²</button>
                <button class="region-btn" data-region="africa">éæ´²</button>
                <button class="region-btn" data-region="oceania">å¤§æ´‹æ´²</button>
            </div>
            
            <div class="filter-container">
                <select id="country-filter">
                    <option value="">æ‰€æœ‰å›½å®¶</option>
                </select>
                <select id="language-filter">
                    <option value="">æ‰€æœ‰è¯­è¨€</option>
                </select>
                
                <div class="custom-select" id="genre-select">
                    <!-- å†…å®¹ç”±JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
            
            <div class="stats">
                <span id="total-stations">åŠ è½½ä¸­...</span>
                <span id="filtered-stations"></span>
            </div>
            
            <div class="loading-progress" id="loading-progress">
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
                <div class="progress-text" id="progress-text">æ­£åœ¨åŠ è½½æ•°æ®...</div>
            </div>
            
            <div class="tabs">
                <div class="tab active" data-tab="all">å…¨éƒ¨ç”µå°</div>
                <div class="tab" data-tab="favorites">æ”¶è—</div>
                <div class="tab" data-tab="history">æ’­æ”¾å†å²</div>
            </div>
            
            <div class="tab-content active" id="all-stations">
                <div class="radio-list" id="radio-list">
                    <div class="loading">
                        <i class="fas fa-spinner fa-spin"></i> æ­£åœ¨åŠ è½½ç”µå°åˆ—è¡¨ï¼Œè¯·ç¨å...
                    </div>
                </div>
                <div class="load-more">
                    <button class="load-more-btn" id="load-more-btn" style="display: none;">åŠ è½½æ›´å¤šç”µå°</button>
                </div>
				<div class="data-source-container">
					<div></div>
					<div class="data-source" id="data-source">æ•°æ®æ¥æº: zyds.net | åœ°åŒº: æ‰€æœ‰åœ°åŒº</div>
				</div>				
            </div>
            
            <div class="tab-content" id="favorites-stations">
                <div class="radio-list" id="favorites-list">
                    <div class="loading">æš‚æ— æ”¶è—çš„ç”µå°</div>
                </div>
            </div>
            
            <div class="tab-content" id="history-stations">
                <div class="radio-list" id="history-list">
                    <div class="loading">æš‚æ— æ’­æ”¾å†å²</div>
                </div>
            </div>
        </div>
        
        <div class="main-content">
            <div class="map-container">
                <h2 class="section-title">ä¸–ç•Œç”µå°åœ°å›¾</h2>
                <div id="map"></div>
                <div class="country-info">
                    <div class="country-name" id="selected-country">å…¨çƒç”µå°</div>
                    <p id="country-station-count">ç‚¹å‡»åœ°å›¾ä¸Šçš„æ ‡è®°æˆ–ä½¿ç”¨ç­›é€‰å™¨é€‰æ‹©ç”µå°</p>
                </div>
            </div>
        </div>
    </div>
    
    <div class="player">
        <div class="now-playing">
            <i class="fas fa-music"></i>
            <span>æ­£åœ¨æ’­æ”¾</span>
        </div>
        
        <div class="player-info">
            <div class="player-station" id="current-station">è¯·é€‰æ‹©ä¸€ä¸ªç”µå°å¼€å§‹æ’­æ”¾</div>
            <div class="player-country" id="current-country"></div>
        </div>
        
        <div class="player-controls">
            <button class="control-btn play-pause" id="play-pause-btn"><i class="fas fa-play"></i></button>
            <button class="control-btn stop-btn" id="stop-btn"><i class="fas fa-stop"></i></button>
            
            <div class="volume-container">
                <button class="control-btn volume-btn"><i class="fas fa-volume-up"></i></button>
                <input type="range" class="volume-slider" min="0" max="100" value="80">
            </div>

            <div class="quality-container">
                <span style="font-size: 0.8rem; color: #aaa;">éŸ³è´¨:</span>
                <select class="quality-select" id="quality-select">
                    <option value="auto">è‡ªåŠ¨</option>
                    <option value="high">é«˜éŸ³è´¨</option>
                    <option value="medium">ä¸­éŸ³è´¨</option>
                    <option value="low">ä½éŸ³è´¨</option>
                </select>
                <span class="quality-indicator" id="quality-indicator"></span>
            </div>

            <div class="share-container">
                <button class="control-btn share-btn" id="share-btn">
                    <i class="fas fa-share-alt"></i>
                </button>
                <div class="share-menu" id="share-menu">
                    <a href="#" class="share-option" data-platform="copy-link">
                        <i class="fas fa-link"></i>
                        <span>å¤åˆ¶åˆ†äº«é“¾æ¥</span>
                    </a>
                    <a href="#" class="share-option" data-platform="wechat">
                        <i class="fab fa-weixin"></i>
                        <span>å¾®ä¿¡</span>
                    </a>
                    <a href="#" class="share-option" data-platform="weibo">
                        <i class="fab fa-weibo"></i>
                        <span>å¾®åš</span>
                    </a>
                    <a href="#" class="share-option" data-platform="qq">
                        <i class="fab fa-qq"></i>
                        <span>QQ</span>
                    </a>
                    <a href="#" class="share-option" data-platform="twitter">
                        <i class="fab fa-twitter"></i>
                        <span>Twitter</span>
                    </a>
                    <a href="#" class="share-option" data-platform="facebook">
                        <i class="fab fa-facebook"></i>
                        <span>Facebook</span>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
	<script>
		// åˆå§‹åŒ–å˜é‡
		let currentStation = null;
		let isPlaying = false;
		let audioPlayer = new Audio();
		let allStations = [];
		let filteredStations = [];
		let displayedStations = [];
		let favoriteStations = [];
		let historyStations = [];
		let map;
		let markers = [];
		let countries = [];
		let languages = [];
		let genres = [];
		let searchTimeout;
		let activeTab = 'all';
		let currentRegion = 'all';
		let currentQuality = 'auto';
		let currentGenre = 'all';
		let displayLimit = 200;
		let displayedCount = 0;
		let mapUpdateTimeout;
		let isDataFullyLoaded = false;
		let isSearching = false;

		// æ•°æ®æºé…ç½®
		const DATA_SOURCES = {
			asia: 'data/asia-stations.json',
			europe: 'data/europe-stations.json',
			'north-america': 'data/north-america-stations.json',
			'south-america': 'data/south-america-stations.json',
			africa: 'data/africa-stations.json',
			oceania: 'data/oceania-stations.json',
			fallback: 'https://de1.api.radio-browser.info/json/stations?limit=5000&hidebroken=true&order=votes&reverse=true'
		};

		// åœ°åŒºåç§°æ˜ å°„
		const regionNames = {
			'all': 'æ‰€æœ‰åœ°åŒº',
			'asia': 'äºšæ´²', 'europe': 'æ¬§æ´²', 'africa': 'éæ´²', 
			'north-america': 'åŒ—ç¾æ´²', 'south-america': 'å—ç¾æ´²', 'oceania': 'å¤§æ´‹æ´²'
		};

		// è¯­è¨€æ˜ å°„
		const languageMapping = {
			'chinese': 'ä¸­æ–‡', 'english': 'è‹±è¯­', 'french': 'æ³•è¯­', 'russian': 'ä¿„è¯­',
			'spanish': 'è¥¿ç­ç‰™è¯­', 'arabic': 'é˜¿æ‹‰ä¼¯è¯­', 'german': 'å¾·è¯­', 'italian': 'æ„å¤§åˆ©è¯­',
			'portuguese': 'è‘¡è„ç‰™è¯­', 'dutch': 'è·å…°è¯­', 'japanese': 'æ—¥è¯­', 'korean': 'éŸ©è¯­',
			'hindi': 'å°åœ°è¯­', 'turkish': 'åœŸè€³å…¶è¯­', 'vietnamese': 'è¶Šå—è¯­', 'thai': 'æ³°è¯­',
			'other': 'å…¶ä»–è¯­è¨€'
		};

		// å›½å®¶åç§°æ˜ å°„
		const countryNameMapping = {
			'China': 'ä¸­å›½', 'Japan': 'æ—¥æœ¬', 'South Korea': 'éŸ©å›½', 'United States': 'ç¾å›½',
			'United Kingdom': 'è‹±å›½', 'Germany': 'å¾·å›½', 'France': 'æ³•å›½', 'Italy': 'æ„å¤§åˆ©',
			'Spain': 'è¥¿ç­ç‰™', 'Canada': 'åŠ æ‹¿å¤§', 'Australia': 'æ¾³å¤§åˆ©äºš', 'Russia': 'ä¿„ç½—æ–¯',
			'Brazil': 'å·´è¥¿', 'India': 'å°åº¦', 'Mexico': 'å¢¨è¥¿å“¥', 'Indonesia': 'å°åº¦å°¼è¥¿äºš',
			'Turkey': 'åœŸè€³å…¶', 'Saudi Arabia': 'æ²™ç‰¹é˜¿æ‹‰ä¼¯', 'South Africa': 'å—é',
			'Egypt': 'åŸƒåŠ', 'Nigeria': 'å°¼æ—¥åˆ©äºš', 'Kenya': 'è‚¯å°¼äºš', 'Argentina': 'é˜¿æ ¹å»·',
			'Chile': 'æ™ºåˆ©', 'Colombia': 'å“¥ä¼¦æ¯”äºš', 'Peru': 'ç§˜é²', 'Vietnam': 'è¶Šå—',
			'Thailand': 'æ³°å›½', 'Malaysia': 'é©¬æ¥è¥¿äºš', 'Singapore': 'æ–°åŠ å¡', 'Philippines': 'è²å¾‹å®¾',
			'Pakistan': 'å·´åŸºæ–¯å¦', 'Bangladesh': 'å­ŸåŠ æ‹‰å›½', 'Iran': 'ä¼Šæœ—', 'Iraq': 'ä¼Šæ‹‰å…‹',
			'Ukraine': 'ä¹Œå…‹å…°', 'Poland': 'æ³¢å…°', 'Netherlands': 'è·å…°', 'Belgium': 'æ¯”åˆ©æ—¶',
			'Sweden': 'ç‘å…¸', 'Norway': 'æŒªå¨', 'Finland': 'èŠ¬å…°', 'Denmark': 'ä¸¹éº¦',
			'Switzerland': 'ç‘å£«', 'Austria': 'å¥¥åœ°åˆ©', 'Portugal': 'è‘¡è„ç‰™', 'Greece': 'å¸Œè…Š',
			'Israel': 'ä»¥è‰²åˆ—', 'United Arab Emirates': 'é˜¿è”é…‹', 'Qatar': 'å¡å¡”å°”'
		};

		// åˆ†ç±»æ˜ å°„
		const genreMapping = {
			'pop': 'æµè¡ŒéŸ³ä¹', 'rock': 'æ‘‡æ»šéŸ³ä¹', 'classical': 'å¤å…¸éŸ³ä¹', 'jazz': 'çˆµå£«éŸ³ä¹',
			'electronic': 'ç”µå­éŸ³ä¹', 'country': 'ä¹¡æ‘éŸ³ä¹', 'news': 'æ–°é—»èµ„è®¯', 'talk': 'è°ˆè¯èŠ‚ç›®',
			'sports': 'ä½“è‚²èŠ‚ç›®', 'education': 'æ•™è‚²èŠ‚ç›®', 'religious': 'å®—æ•™èŠ‚ç›®', 'oldies': 'ç»å…¸è€æ­Œ'
		};

		// æ˜¾ç¤ºåŠ è½½çŠ¶æ€
		function showLoadingState(message) {
			const radioList = document.getElementById('radio-list');
			if (radioList) {
				radioList.innerHTML = `<div class="loading"><i class="fas fa-spinner fa-spin"></i> ${message}</div>`;
			}
		}

		// æ˜¾ç¤ºåŠ è½½è¿›åº¦
		function showLoadingProgress(percent, message) {
			const progressElement = document.getElementById('loading-progress');
			const progressFill = document.getElementById('progress-fill');
			const progressText = document.getElementById('progress-text');
			
			if (progressElement && progressFill && progressText) {
				progressElement.style.display = 'block';
				progressFill.style.width = percent + '%';
				progressText.textContent = message;
			}
		}

		// éšè—åŠ è½½è¿›åº¦
		function hideLoadingProgress() {
			const progressElement = document.getElementById('loading-progress');
			if (progressElement) {
				progressElement.style.display = 'none';
			}
		}

		// æ™ºèƒ½æ•°æ®åŠ è½½æ–¹æ¡ˆ
		async function loadRegionalData(region = 'all') {
			console.log('å¼€å§‹æ™ºèƒ½åŠ è½½åœ°åŒºæ•°æ®...');
			showLoadingState('æ­£åœ¨å¿«é€ŸåŠ è½½ç”µå°æ•°æ®...');
			showLoadingProgress(10, 'æ­£åœ¨åˆå§‹åŒ–...');
			
			try {
				// ç¬¬ä¸€é˜¶æ®µï¼šå¿«é€ŸåŠ è½½å‰200ä¸ªç”µå°
				showLoadingProgress(30, 'æ­£åœ¨åŠ è½½çƒ­é—¨ç”µå°...');
				const quickStations = await loadQuickData(region, 200);
				allStations = quickStations;
				filteredStations = [...quickStations];
				isDataFullyLoaded = false;
				
				// ç«‹å³æ˜¾ç¤º
				displayedCount = 0;
				displayedStations = [];
				loadMoreStations();
				updateStats();
				showLoadingProgress(60, 'æ­£åœ¨æ¸²æŸ“ç•Œé¢...');
				
				// ç¬¬äºŒé˜¶æ®µï¼šåå°åŠ è½½å®Œæ•´æ•°æ®
				setTimeout(() => {
					loadFullDataInBackground(region);
				}, 500);
				
				hideLoadingProgress();
				console.log(`âœ… å¿«é€ŸåŠ è½½å®Œæˆ: ${quickStations.length} ä¸ªç”µå°`);
				updateDataSource('ZYDS.NETæ•°æ®', regionNames[region]);
				return true;
				
			} catch (error) {
				console.error('æ•°æ®åŠ è½½å¤±è´¥:', error);
				hideLoadingProgress();
				await loadFallbackData();
				return false;
			}
		}

		// å¿«é€ŸåŠ è½½æ•°æ®ï¼ˆé™åˆ¶æ•°é‡ï¼‰
		async function loadQuickData(region, limit = 200) {
			const regionalSources = region === 'all' ? [
				DATA_SOURCES.asia, DATA_SOURCES.europe, DATA_SOURCES['north-america'],
				DATA_SOURCES['south-america'], DATA_SOURCES.africa, DATA_SOURCES.oceania
			] : [DATA_SOURCES[region]];
			
			let allStations = [];
			const seenUuids = new Set();
			
			for (const source of regionalSources) {
				if (allStations.length >= limit) break;
				
				try {
					const response = await fetch(source);
					if (!response.ok) continue;
					
					const data = await response.json();
					const stations = (data.stations || data);
					
					for (const station of stations) {
						if (allStations.length >= limit) break;
						
						if (station && station.stationuuid && !seenUuids.has(station.stationuuid)) {
							seenUuids.add(station.stationuuid);
							allStations.push(station);
						}
					}
					
				} catch (error) {
					console.warn(`å¿«é€ŸåŠ è½½å¤±è´¥ ${source}:`, error);
				}
			}
			
			return allStations;
		}

		// åå°åŠ è½½å®Œæ•´æ•°æ®
		async function loadFullDataInBackground(region) {
			try {
				showLoadingProgress(70, 'æ­£åœ¨åŠ è½½å®Œæ•´æ•°æ®...');
				const fullStations = await loadAllStationsData(region);
				allStations = fullStations;
				isDataFullyLoaded = true;
				
				// å¦‚æœå½“å‰æ²¡æœ‰åœ¨è¿›è¡Œæœç´¢ï¼Œæ›´æ–°ç­›é€‰ç»“æœ
				if (!isSearching) {
					filteredStations = [...fullStations];
					updateStats();
					updateLoadMoreButton();
				}
				
				showLoadingProgress(100, 'æ•°æ®åŠ è½½å®Œæˆ!');
				setTimeout(hideLoadingProgress, 1000);
				
				console.log(`âœ… åå°å®Œæ•´æ•°æ®åŠ è½½å®Œæˆ: ${fullStations.length} ä¸ªç”µå°`);
			} catch (error) {
				console.error('åå°æ•°æ®åŠ è½½å¤±è´¥:', error);
				hideLoadingProgress();
			}
		}

		// åŠ è½½å®Œæ•´æ•°æ®ï¼ˆæ— æ•°é‡é™åˆ¶ï¼‰
		async function loadAllStationsData(region) {
			const regionalSources = region === 'all' ? [
				DATA_SOURCES.asia, DATA_SOURCES.europe, DATA_SOURCES['north-america'],
				DATA_SOURCES['south-america'], DATA_SOURCES.africa, DATA_SOURCES.oceania
			] : [DATA_SOURCES[region]];
			
			let allStations = [];
			const seenUuids = new Set();
			
			for (const source of regionalSources) {
				try {
					const response = await fetch(source);
					if (!response.ok) continue;
					
					const data = await response.json();
					const stations = (data.stations || data);
					
					stations.forEach(station => {
						if (station && station.stationuuid && !seenUuids.has(station.stationuuid)) {
							seenUuids.add(station.stationuuid);
							allStations.push(station);
						}
					});
					
				} catch (error) {
					console.warn(`å®Œæ•´åŠ è½½å¤±è´¥ ${source}:`, error);
				}
			}
			
			return allStations;
		}

		// æœç´¢æ—¶åŠ è½½å®Œæ•´æ•°æ®
		async function loadFullDataForSearch() {
			showLoadingState('æ­£åœ¨åŠ è½½å®Œæ•´æ•°æ®ä»¥ç¡®ä¿æœç´¢å‡†ç¡®æ€§...');
			showLoadingProgress(50, 'æ­£åœ¨åŠ è½½å®Œæ•´ç”µå°æ•°æ®...');
			
			try {
				const region = currentRegion;
				const fullStations = await loadAllStationsData(region);
				allStations = fullStations;
				isDataFullyLoaded = true;
				
				hideLoadingProgress();
				console.log(`ğŸ” ä¸ºæœç´¢åŠ è½½å®Œæ•´æ•°æ®: ${fullStations.length} ä¸ªç”µå°`);
				return fullStations;
			} catch (error) {
				console.error('æœç´¢æ•°æ®åŠ è½½å¤±è´¥:', error);
				hideLoadingProgress();
				return allStations;
			}
		}

		// åŠ è½½å¤‡ç”¨æ•°æ®
		async function loadFallbackData() {
			console.log('ä½¿ç”¨å¤‡ç”¨APIè·å–æ•°æ®...');
			updateDataSource('å¤‡ç”¨API', regionNames[currentRegion]);
			
			try {
				const response = await fetch(DATA_SOURCES.fallback);
				const stations = await response.json();
				
				if (stations && stations.length > 0) {
					processStationsData(stations);
					console.log(`âœ… ä»APIåŠ è½½äº† ${stations.length} ä¸ªç”µå°`);
				} else {
					throw new Error('APIè¿”å›ç©ºæ•°æ®');
				}
			} catch (error) {
				console.error('å¤‡ç”¨APIåŠ è½½å¤±è´¥:', error);
				const mockStations = generateMockStations();
				processStationsData(mockStations);
				updateDataSource('æ¨¡æ‹Ÿæ•°æ®', regionNames[currentRegion]);
			}
		}

		// å¤„ç†ç”µå°æ•°æ®
		function processStationsData(stations) {
			const uniqueStationsMap = new Map();
			stations.forEach(station => {
				if (station && station.stationuuid) {
					uniqueStationsMap.set(station.stationuuid, station);
				}
			});
			
			allStations = Array.from(uniqueStationsMap.values()).filter(station => 
				station && (station.url_resolved || station.url)
			);
			
			console.log(`åŸå§‹æ•°æ®: ${stations.length} ä¸ª, å»é‡å: ${allStations.length} ä¸ª`);
			
			updateStats();
			extractFilterOptions();
			
			displayedCount = 0;
			displayedStations = [];
			filteredStations = [...allStations];
			
			loadMoreStations();
			updateMapMarkers(allStations.slice(0, 100));
		}

		// ç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®
		function generateMockStations() {
			const stations = [];
			const countries = ['ä¸­å›½', 'ç¾å›½', 'è‹±å›½', 'æ—¥æœ¬', 'å¾·å›½', 'æ³•å›½', 'æ¾³å¤§åˆ©äºš', 'åŠ æ‹¿å¤§', 'å·´è¥¿', 'ä¿„ç½—æ–¯'];
			
			for (let i = 1; i <= 50; i++) {
				const country = countries[Math.floor(Math.random() * countries.length)];
				
				stations.push({
					stationuuid: `station-${i}`,
					name: `${country}ç”µå°${i}`,
					country: country,
					countrycode: getCountryCode(country),
					url_resolved: `https://example.com/stream${i}.mp3`,
					tags: 'æµè¡ŒéŸ³ä¹,æ–°é—»èµ„è®¯',
					language: 'ä¸­æ–‡',
					votes: Math.floor(Math.random() * 1000),
					geo_lat: 20 + Math.random() * 50,
					geo_long: -120 + Math.random() * 240
				});
			}
			
			return stations;
		}

		// è·å–å›½å®¶ä»£ç 
		function getCountryCode(country) {
			const codes = {
				'ä¸­å›½': 'CN', 'ç¾å›½': 'US', 'è‹±å›½': 'GB', 'æ—¥æœ¬': 'JP', 
				'å¾·å›½': 'DE', 'æ³•å›½': 'FR', 'æ¾³å¤§åˆ©äºš': 'AU', 'åŠ æ‹¿å¤§': 'CA',
				'å·´è¥¿': 'BR', 'ä¿„ç½—æ–¯': 'RU'
			};
			return codes[country] || 'UN';
		}

		// è·å–ä¸­æ–‡å›½å®¶åç§°
		function getChineseCountryName(englishName) {
			if (!englishName) return 'æœªçŸ¥å›½å®¶';
			
			const cleanName = englishName.replace(/^The\s+/i, '').trim();
			
			if (countryNameMapping[englishName]) {
				return countryNameMapping[englishName];
			}
			
			if (countryNameMapping[cleanName]) {
				return countryNameMapping[cleanName];
			}
			
			return englishName;
		}

		// æå–ç­›é€‰é€‰é¡¹
		function extractFilterOptions() {
			extractCountries();
			extractLanguages();
		}

		// æå–å›½å®¶åˆ—è¡¨
		function extractCountries() {
			const countrySet = new Set();
			allStations.forEach(station => {
				if (station.country) {
					const chineseName = getChineseCountryName(station.country);
					countrySet.add(chineseName);
				}
			});
			
			countries = Array.from(countrySet).sort();
			
			const countryFilter = document.getElementById('country-filter');
			countryFilter.innerHTML = '<option value="">æ‰€æœ‰å›½å®¶</option>';
			
			countries.forEach(country => {
				const option = document.createElement('option');
				option.value = country;
				option.textContent = country;
				countryFilter.appendChild(option);
			});
		}

		// æå–è¯­è¨€åˆ—è¡¨
		function extractLanguages() {
			const languageSet = new Set();
			
			allStations.forEach(station => {
				if (station.language) {
					const stationLanguages = station.language.split(',').map(lang => lang.trim().toLowerCase());
					stationLanguages.forEach(lang => {
						if (lang && languageMapping[lang]) {
							languageSet.add(languageMapping[lang]);
						} else if (lang) {
							languageSet.add('å…¶ä»–è¯­è¨€');
						}
					});
				}
			});
			
			languages = Array.from(languageSet).sort();
			
			const languageFilter = document.getElementById('language-filter');
			languageFilter.innerHTML = '<option value="">æ‰€æœ‰è¯­è¨€</option>';
			
			languages.forEach(language => {
				const option = document.createElement('option');
				option.value = language;
				option.textContent = language;
				languageFilter.appendChild(option);
			});
		}

		// åŠ è½½æ›´å¤šç”µå°
		function loadMoreStations() {
			const startIndex = displayedCount;
			const endIndex = Math.min(displayedCount + 50, filteredStations.length);
			
			if (startIndex >= filteredStations.length) {
				document.getElementById('load-more-btn').style.display = 'none';
				return;
			}
			
			const stationsToAdd = filteredStations.slice(startIndex, endIndex);
			displayedStations = displayedStations.concat(stationsToAdd);
			displayedCount = endIndex;
			
			renderRadioList(displayedStations, document.getElementById('radio-list'), 'all');
			updateStats();
			updateLoadMoreButton();
		}

		// æ›´æ–°åŠ è½½æ›´å¤šæŒ‰é’®
		function updateLoadMoreButton() {
			const loadMoreBtn = document.getElementById('load-more-btn');
			if (displayedCount >= filteredStations.length) {
				loadMoreBtn.style.display = 'none';
			} else {
				loadMoreBtn.style.display = 'block';
				const remaining = filteredStations.length - displayedCount;
				loadMoreBtn.textContent = `åŠ è½½æ›´å¤š (${remaining} ä¸ªç”µå°)`;
			}
		}

		// æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
		function updateStats() {
			const totalDisplay = isDataFullyLoaded ? 
				`${allStations.length.toLocaleString()} ç”µå° / ${countries.length} å›½å®¶` :
				`${allStations.length.toLocaleString()}+ ç”µå° / åŠ è½½ä¸­...`;
			
			document.getElementById('total-stations').textContent = totalDisplay;
			
			const currentDisplayCount = Math.min(displayedCount, filteredStations.length);
			const displayedCountText = `æ˜¾ç¤º: ${currentDisplayCount}/${filteredStations.length}`;
			document.getElementById('filtered-stations').textContent = displayedCountText;
		}

		// æ›´æ–°æ•°æ®æºæ˜¾ç¤º
		function updateDataSource(source, region = 'æ‰€æœ‰åœ°åŒº') {
			const sourceElement = document.getElementById('data-source');
			if (sourceElement) {
				sourceElement.textContent = `æ•°æ®æ¥æº: ${source} | åœ°åŒº: ${region}`;
			}
		}

		// æ ¼å¼åŒ–åˆ†ç±»æ˜¾ç¤º
		function formatGenre(genre) {
			const genreLower = genre.toLowerCase();
			if (genreMapping[genreLower]) {
				return genreMapping[genreLower];
			}
			return genre;
		}

		// æ ¼å¼åŒ–æ ‡ç­¾æ˜¾ç¤º
		function formatGenres(tags) {
			if (!tags) return 'æœªåˆ†ç±»';
			
			const genreList = tags.split(',').slice(0, 2).map(genre => {
				return formatGenre(genre.trim());
			});
			
			return genreList.join(' Â· ');
		}

		// æ¸²æŸ“ç”µå°åˆ—è¡¨
		function renderRadioList(stations = displayedStations, container = document.getElementById('radio-list'), listType = 'all') {
			if (!container) return;
			
			if (stations.length === 0) {
				if (listType === 'favorites') {
					container.innerHTML = '<div class="loading">æš‚æ— æ”¶è—çš„ç”µå°</div>';
				} else if (listType === 'history') {
					container.innerHTML = '<div class="loading">æš‚æ— æ’­æ”¾å†å²</div>';
				} else {
					container.innerHTML = '<div class="loading">æœªæ‰¾åˆ°åŒ¹é…çš„ç”µå°</div>';
				}
				return;
			}
			
			container.innerHTML = '';
			
			stations.forEach(station => {
				const radioItem = document.createElement('div');
				radioItem.className = 'radio-item';
				if (currentStation && currentStation.stationuuid === station.stationuuid) {
					radioItem.classList.add('active');
				}
				radioItem.dataset.id = station.stationuuid;
				
				const flagEmoji = getFlagEmoji(station.countrycode);
				const isFavorite = favoriteStations.some(fav => fav.stationuuid === station.stationuuid);
				const countryName = getChineseCountryName(station.country);
				
				radioItem.innerHTML = `
					<button class="favorite-btn ${isFavorite ? 'active' : ''}" data-id="${station.stationuuid}">
						<i class="fas fa-heart"></i>
					</button>
					<div class="radio-flag">${flagEmoji}</div>
					<div class="radio-info">
						<div class="radio-name">${station.name || 'æœªçŸ¥ç”µå°'}</div>
						<div class="radio-country">${countryName || 'æœªçŸ¥å›½å®¶'}</div>
						<div class="radio-genre">${formatGenres(station.tags)}</div>
					</div>
					<button class="play-btn" data-id="${station.stationuuid}">
						<i class="fas fa-play"></i>
					</button>
				`;
				
				container.appendChild(radioItem);
			});
			
			attachEventListeners();
		}

		// é™„åŠ äº‹ä»¶ç›‘å¬å™¨
		function attachEventListeners() {
			document.querySelectorAll('.play-btn').forEach(btn => {
				btn.addEventListener('click', function(e) {
					e.stopPropagation();
					const stationId = this.dataset.id;
					playStation(stationId);
				});
			});
			
			document.querySelectorAll('.favorite-btn').forEach(btn => {
				btn.addEventListener('click', function(e) {
					e.stopPropagation();
					const stationId = this.dataset.id;
					toggleFavorite(stationId);
				});
			});
			
			document.querySelectorAll('.radio-item').forEach(item => {
				item.addEventListener('click', function() {
					const stationId = this.dataset.id;
					playStation(stationId);
				});
			});
		}

		// æ’­æ”¾ç”µå°
		function playStation(stationId) {
			const station = allStations.find(s => s.stationuuid === stationId);
			if (!station) return;
			
			currentStation = station;
			document.getElementById('current-station').textContent = station.name || 'æœªçŸ¥ç”µå°';
			
			const countryName = getChineseCountryName(station.country);
			document.getElementById('current-country').textContent = `${countryName || 'æœªçŸ¥å›½å®¶'} â€¢ ${formatGenres(station.tags)}`;
			
			const playPauseBtn = document.getElementById('play-pause-btn');
			playPauseBtn.innerHTML = '<i class="fas fa-pause"></i>';
			isPlaying = true;
			
			addToHistory(station);
			
			// æ›´æ–°ç”µå°åˆ—è¡¨é«˜äº®
			document.querySelectorAll('.radio-item').forEach(item => {
				item.classList.remove('active');
				if (item.dataset.id === stationId) {
					item.classList.add('active');
				}
			});
			
			// æ£€æµ‹éŸ³è´¨ä¿¡æ¯
			detectAndDisplayQuality(station);
			
			// åœ°å›¾è·³è½¬
			if (station.geo_lat && station.geo_long) {
				map.setView([station.geo_lat, station.geo_long], 6, {
					animate: true,
					duration: 1.0
				});
				
				markers.forEach(marker => {
					const markerLat = marker.getLatLng().lat;
					const markerLng = marker.getLatLng().lng;
					
					const latDiff = Math.abs(markerLat - station.geo_lat);
					const lngDiff = Math.abs(markerLng - station.geo_long);
					
					if (latDiff < 0.001 && lngDiff < 0.001) {
						marker.openPopup();
					}
				});
			}
			
			// éŸ³é¢‘æ’­æ”¾
			audioPlayer.pause();
			
			const streamUrl = station.url_resolved || station.url;
			if (streamUrl) {
				audioPlayer.src = streamUrl;
				audioPlayer.play().catch(error => {
					console.error('æ’­æ”¾å¤±è´¥:', error);
					document.getElementById('current-station').textContent = 'æ’­æ”¾å¤±è´¥ï¼Œè¯·å°è¯•å…¶ä»–ç”µå°';
					playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
					isPlaying = false;
				});
			}
			
			// è‡ªåŠ¨æ»šåŠ¨
			scrollToCurrentStation(stationId);
		}

		// è‡ªåŠ¨æ»šåŠ¨åˆ°å½“å‰æ’­æ”¾çš„ç”µå°
		function scrollToCurrentStation(stationId) {
			const radioList = document.getElementById('radio-list');
			const currentItem = radioList.querySelector(`[data-id="${stationId}"]`);
			
			if (currentItem) {
				currentItem.scrollIntoView({
					behavior: 'smooth',
					block: 'center'
				});
			}
		}

		// æ£€æµ‹å¹¶æ˜¾ç¤ºéŸ³è´¨ä¿¡æ¯
		function detectAndDisplayQuality(station) {
			const qualityIndicator = document.getElementById('quality-indicator');
			let quality = 'æœªçŸ¥';
			
			if (station.tags) {
				const tags = station.tags.toLowerCase().split(',');
				if (tags.includes('high') || tags.includes('hq') || tags.includes('320')) {
					quality = 'é«˜éŸ³è´¨';
				} else if (tags.includes('medium') || tags.includes('128')) {
					quality = 'ä¸­éŸ³è´¨';
				} else if (tags.includes('low') || tags.includes('64')) {
					quality = 'ä½éŸ³è´¨';
				}
			}
			
			if (station.bitrate) {
				if (station.bitrate >= 256) {
					quality = 'é«˜éŸ³è´¨';
				} else if (station.bitrate >= 128) {
					quality = 'ä¸­éŸ³è´¨';
				} else {
					quality = 'ä½éŸ³è´¨';
				}
			}
			
			qualityIndicator.textContent = `(${quality})`;
		}

		// æ ¹æ®å›½å®¶ä»£ç è·å–å›½æ——emoji
		function getFlagEmoji(countryCode) {
			if (!countryCode) return 'ğŸŒ';
			
			const codePoints = countryCode
				.toUpperCase()
				.split('')
				.map(char => 127397 + char.charCodeAt());
			return String.fromCodePoint(...codePoints);
		}

		// åˆå§‹åŒ–åœ°å›¾
		function initMap() {
			map = L.map('map').setView([20, 0], 3);
			
			L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
				attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
			}).addTo(map);
		}

		// æ›´æ–°åœ°å›¾æ ‡è®°
		function updateMapMarkers(stations) {
			markers.forEach(marker => map.removeLayer(marker));
			markers = [];
			
			const displayLimit = 100;
			const stationsToShow = stations.slice(0, displayLimit);
			
			stationsToShow.forEach((station, index) => {
				if (station.geo_lat && station.geo_long) {
					setTimeout(() => {
						if (index < stationsToShow.length) {
							addStationMarker(station);
						}
					}, index * 10);
				}
			});
		}

		function addStationMarker(station) {
			const flagEmoji = getFlagEmoji(station.countrycode);
			const countryName = getChineseCountryName(station.country);
			
			const marker = L.marker([station.geo_lat, station.geo_long])
				.addTo(map)
				.bindPopup(`
					<div style="color: black; min-width: 200px;">
						<b>${station.name || 'æœªçŸ¥ç”µå°'}</b><br>
						${countryName || ''}<br>
						<small>${formatGenres(station.tags)}</small><br>
						<button onclick="window.playStationFromMap('${station.stationuuid}')" 
								style="background:#e52e71;color:white;border:none;padding:5px 10px;border-radius:5px;cursor:pointer;margin-top:5px;">
							æ’­æ”¾
						</button>
					</div>
				`);
			
			marker.on('click', function() {
				playStation(station.stationuuid);
			});
			
			markers.push(marker);
		}

		// ä»åœ°å›¾æ’­æ”¾ç”µå°
		window.playStationFromMap = function(stationId) {
			playStation(stationId);
		};

		// æ™ºèƒ½æœç´¢åŠŸèƒ½
		async function performSearch() {
			isSearching = true;
			
			const searchTerm = document.getElementById('search-input').value.toLowerCase();
			const countryFilter = document.getElementById('country-filter').value;
			const languageFilter = document.getElementById('language-filter').value;
			
			// æ˜¾ç¤ºæœç´¢ä¸­çš„çŠ¶æ€
			const radioList = document.getElementById('radio-list');
			radioList.innerHTML = `
				<div class="loading">
					<i class="fas fa-search fa-spin"></i> 
					${isDataFullyLoaded ? 'æ­£åœ¨æœç´¢...' : 'æ­£åœ¨åŠ è½½å®Œæ•´æ•°æ®ä»¥è¿›è¡Œæœç´¢...'}
				</div>
			`;
			
			// å¦‚æœè¿˜æ²¡æœ‰åŠ è½½å®Œæ•´æ•°æ®ï¼Œå…ˆåŠ è½½å®Œæ•´æ•°æ®
			if (!isDataFullyLoaded) {
				await loadFullDataForSearch();
			}
			
			// æ‰§è¡Œæœç´¢ï¼ˆä½¿ç”¨å®Œæ•´æ•°æ®ï¼‰
			setTimeout(() => {
				filteredStations = allStations.filter(station => {
					const matchesSearch = searchTerm === '' || 
						(station.name && station.name.toLowerCase().includes(searchTerm)) || 
						(station.country && station.country.toLowerCase().includes(searchTerm)) ||
						(station.tags && station.tags.toLowerCase().includes(searchTerm));
					
					let matchesCountry = true;
					if (countryFilter !== '') {
						const englishCountryName = Object.keys(countryNameMapping).find(
							key => countryNameMapping[key] === countryFilter
						) || countryFilter;
						matchesCountry = station.country && (
							station.country.toLowerCase().includes(englishCountryName.toLowerCase()) ||
							(getChineseCountryName(station.country) && getChineseCountryName(station.country) === countryFilter)
						);
					}
					
					let matchesLanguage = true;
					if (languageFilter !== '') {
						const englishKeyword = Object.keys(languageMapping).find(key => 
							languageMapping[key] === languageFilter
						) || '';
						matchesLanguage = station.language && 
							station.language.toLowerCase().includes(englishKeyword.toLowerCase());
					}
					
					let matchesGenre = true;
					if (currentGenre !== 'all' && currentGenre !== '') {
						const englishKeyword = Object.keys(genreMapping).find(key => 
							genreMapping[key] === currentGenre
						) || '';
						matchesGenre = station.tags && 
							station.tags.toLowerCase().includes(englishKeyword.toLowerCase());
					}
					
					let matchesRegion = true;
					if (currentRegion !== 'all') {
						const regionCountries = getRegionCountries(currentRegion);
						matchesRegion = regionCountries.some(country => {
							const chineseCountryName = getChineseCountryName(country);
							const stationChineseName = getChineseCountryName(station.country);
							return station.country && (
								station.country.toLowerCase().includes(country.toLowerCase()) ||
								stationChineseName.includes(chineseCountryName)
							);
						});
					}
					
					return matchesSearch && matchesCountry && matchesLanguage && matchesGenre && matchesRegion;
				});
				
				displayedCount = 0;
				displayedStations = [];
				
				if (activeTab === 'all') {
					loadMoreStations();
				}
				
				updateMapMarkers(filteredStations.slice(0, 100));
				updateCountryInfo();
				
				isSearching = false;
			}, 100);
		}

		// è·å–åœ°åŒºå¯¹åº”çš„å›½å®¶åˆ—è¡¨
		function getRegionCountries(region) {
			const regionCountriesMap = {
				'asia': ['China', 'Japan', 'South Korea', 'India', 'Indonesia', 'Thailand', 'Vietnam', 'Malaysia'],
				'europe': ['United Kingdom', 'Germany', 'France', 'Italy', 'Spain', 'Netherlands', 'Sweden', 'Norway'],
				'north-america': ['United States', 'Canada', 'Mexico', 'Cuba'],
				'south-america': ['Brazil', 'Argentina', 'Chile', 'Colombia', 'Peru'],
				'africa': ['South Africa', 'Egypt', 'Nigeria', 'Kenya', 'Morocco'],
				'oceania': ['Australia', 'New Zealand', 'Fiji']
			};
			return regionCountriesMap[region] || [];
		}

		// æ›´æ–°å›½å®¶ä¿¡æ¯æ˜¾ç¤º
		function updateCountryInfo() {
			const countryName = document.getElementById('selected-country');
			const countryCount = document.getElementById('country-station-count');
			
			if (currentRegion !== 'all') {
				countryName.textContent = `${regionNames[currentRegion]}åœ°åŒºç”µå°`;
				countryCount.textContent = `æ‰¾åˆ° ${filteredStations.length} ä¸ªç”µå°`;
			} else if (document.getElementById('country-filter').value) {
				const selectedCountry = document.getElementById('country-filter').value;
				countryName.textContent = `${selectedCountry}ç”µå°`;
				countryCount.textContent = `æ‰¾åˆ° ${filteredStations.length} ä¸ªç”µå°`;
			} else {
				countryName.textContent = 'å…¨çƒç”µå°';
				countryCount.textContent = `ç‚¹å‡»åœ°å›¾ä¸Šçš„æ ‡è®°æˆ–ä½¿ç”¨ç­›é€‰å™¨é€‰æ‹©ç”µå° (${filteredStations.length} ä¸ªç”µå°)`;
			}
		}

		// é˜²æŠ–æœç´¢
		function debounceSearch() {
			clearTimeout(searchTimeout);
			searchTimeout = setTimeout(performSearch, 300);
		}

		// åˆ‡æ¢æ”¶è—çŠ¶æ€
		function toggleFavorite(stationId) {
			const station = allStations.find(s => s.stationuuid === stationId);
			if (!station) return;
			
			const index = favoriteStations.findIndex(fav => fav.stationuuid === stationId);
			
			if (index === -1) {
				favoriteStations.push(station);
			} else {
				favoriteStations.splice(index, 1);
			}
			
			saveLocalData();
			
			if (activeTab === 'all') {
				renderRadioList();
			} else if (activeTab === 'favorites') {
				updateTabs();
			}
		}

		// æ·»åŠ åˆ°æ’­æ”¾å†å²
		function addToHistory(station) {
			const existingIndex = historyStations.findIndex(item => 
				item.station.stationuuid === station.stationuuid
			);
			
			if (existingIndex !== -1) {
				historyStations.splice(existingIndex, 1);
			}
			
			historyStations.push({
				station: station,
				timestamp: Date.now()
			});
			
			if (historyStations.length > 50) {
				historyStations = historyStations.slice(-50);
			}
			
			saveLocalData();
			
			if (activeTab === 'history') {
				updateTabs();
			}
		}

		// åŠ è½½æœ¬åœ°æ•°æ®
		function loadLocalData() {
			const storedFavorites = localStorage.getItem('radioFavorites');
			const storedHistory = localStorage.getItem('radioHistory');
			
			if (storedFavorites) {
				favoriteStations = JSON.parse(storedFavorites);
			}
			
			if (storedHistory) {
				historyStations = JSON.parse(storedHistory);
			}
		}

		// ä¿å­˜æ•°æ®åˆ°localStorage
		function saveLocalData() {
			localStorage.setItem('radioFavorites', JSON.stringify(favoriteStations));
			localStorage.setItem('radioHistory', JSON.stringify(historyStations));
		}

		// æ›´æ–°æ ‡ç­¾é¡µå†…å®¹
		function updateTabs() {
			if (activeTab === 'favorites') {
				renderRadioList(favoriteStations, document.getElementById('favorites-list'), 'favorites');
			} else if (activeTab === 'history') {
				renderHistoryList();
			}
		}

		// æ¸²æŸ“å†å²åˆ—è¡¨
		function renderHistoryList() {
			const historyList = document.getElementById('history-list');
			
			if (historyStations.length === 0) {
				historyList.innerHTML = '<div class="loading">æš‚æ— æ’­æ”¾å†å²</div>';
				return;
			}
			
			historyList.innerHTML = '';
			
			const recentHistory = historyStations.slice(-20).reverse();
			
			recentHistory.forEach(item => {
				const historyItem = document.createElement('div');
				historyItem.className = 'history-item';
				historyItem.dataset.id = item.station.stationuuid;
				
				const flagEmoji = getFlagEmoji(item.station.countrycode);
				const timeString = new Date(item.timestamp).toLocaleString();
				const countryName = getChineseCountryName(item.station.country);
				
				historyItem.innerHTML = `
					<div class="radio-flag">${flagEmoji}</div>
					<div class="radio-info">
						<div class="radio-name">${item.station.name || 'æœªçŸ¥ç”µå°'}</div>
						<div class="radio-country">${countryName || 'æœªçŸ¥å›½å®¶'}</div>
						<div class="history-time">${timeString}</div>
					</div>
					<button class="play-btn" data-id="${item.station.stationuuid}">
						<i class="fas fa-play"></i>
					</button>
				`;
				
				historyList.appendChild(historyItem);
			});
			
			attachEventListeners();
		}

		// æ’­æ”¾æ§åˆ¶
		function togglePlayPause() {
			if (!currentStation) {
				if (filteredStations.length > 0) {
					playStation(filteredStations[0].stationuuid);
				}
				return;
			}
			
			if (isPlaying) {
				document.getElementById('play-pause-btn').innerHTML = '<i class="fas fa-play"></i>';
				audioPlayer.pause();
			} else {
				document.getElementById('play-pause-btn').innerHTML = '<i class="fas fa-pause"></i>';
				audioPlayer.play().catch(error => {
					console.error('æ’­æ”¾å¤±è´¥:', error);
					document.getElementById('play-pause-btn').innerHTML = '<i class="fas fa-play"></i>';
				});
			}
			
			isPlaying = !isPlaying;
		}

		function stopPlayback() {
			audioPlayer.pause();
			audioPlayer.currentTime = 0;
			isPlaying = false;
			document.getElementById('play-pause-btn').innerHTML = '<i class="fas fa-play"></i>';
		}

		function updateVolume() {
			audioPlayer.volume = document.querySelector('.volume-slider').value / 100;
		}

		// ç§»åŠ¨ç«¯å¸ƒå±€è°ƒæ•´
		function adjustMobileLayout() {
			if (window.innerWidth <= 768) {
				const viewportHeight = window.innerHeight;
				const headerHeight = document.querySelector('header').offsetHeight;
				const playerHeight = document.querySelector('.player').offsetHeight;
				
				const availableHeight = viewportHeight - headerHeight - playerHeight - 40;
				
				const sidebar = document.querySelector('.sidebar');
				if (sidebar) {
					sidebar.style.height = `${availableHeight * 0.65}px`;
				}
				
				const mapContainer = document.querySelector('.map-container');
				if (mapContainer) {
					mapContainer.style.height = `${availableHeight * 0.35}px`;
				}
			}
		}

		// åˆå§‹åŒ–è‡ªå®šä¹‰é€‰æ‹©å™¨
		function initCustomSelect() {
			const customSelect = document.getElementById('genre-select');
			
			customSelect.innerHTML = `
				<div class="select-selected" style="font-weight: bold; color: #ff8a00;">æ‰€æœ‰åˆ†ç±»</div>
				<div class="select-items">
					<div class="select-header">
						<div class="select-item active" data-value="all" style="background: rgba(255, 138, 0, 0.2); font-weight: bold;">
							<i class="fas fa-globe"></i> æ‰€æœ‰åˆ†ç±»
						</div>
					</div>
					
					<div class="select-category">
						<div class="category-title">
							<i class="fas fa-fire"></i> çƒ­é—¨åˆ†ç±»
						</div>
						<div class="select-hot-grid">
							<div class="select-item hot-genre" data-value="æµè¡ŒéŸ³ä¹">æµè¡ŒéŸ³ä¹</div>
							<div class="select-item hot-genre" data-value="æ–°é—»èµ„è®¯">æ–°é—»èµ„è®¯</div>
							<div class="select-item hot-genre" data-value="æ‘‡æ»šéŸ³ä¹">æ‘‡æ»šéŸ³ä¹</div>
							<div class="select-item hot-genre" data-value="è°ˆè¯èŠ‚ç›®">è°ˆè¯èŠ‚ç›®</div>
							<div class="select-item hot-genre" data-value="å¤å…¸éŸ³ä¹">å¤å…¸éŸ³ä¹</div>
							<div class="select-item hot-genre" data-value="ä½“è‚²èŠ‚ç›®">ä½“è‚²èŠ‚ç›®</div>
						</div>
					</div>
					
					<div class="select-columns">
						<div class="select-category">
							<div class="category-title">
								<i class="fas fa-music"></i> éŸ³ä¹åˆ†ç±»
							</div>
							<div class="select-item" data-value="æµè¡ŒéŸ³ä¹">æµè¡ŒéŸ³ä¹</div>
							<div class="select-item" data-value="æ‘‡æ»šéŸ³ä¹">æ‘‡æ»šéŸ³ä¹</div>
							<div class="select-item" data-value="å¤å…¸éŸ³ä¹">å¤å…¸éŸ³ä¹</div>
							<div class="select-item" data-value="çˆµå£«éŸ³ä¹">çˆµå£«éŸ³ä¹</div>
							<div class="select-item" data-value="ç”µå­éŸ³ä¹">ç”µå­éŸ³ä¹</div>
						</div>
						
						<div class="select-category">
							<div class="category-title">
								<i class="fas fa-newspaper"></i> èµ„è®¯èŠ‚ç›®
							</div>
							<div class="select-item" data-value="æ–°é—»èµ„è®¯">æ–°é—»èµ„è®¯</div>
							<div class="select-item" data-value="è°ˆè¯èŠ‚ç›®">è°ˆè¯èŠ‚ç›®</div>
							<div class="select-item" data-value="ä½“è‚²èŠ‚ç›®">ä½“è‚²èŠ‚ç›®</div>
							<div class="select-item" data-value="è´¢ç»èŠ‚ç›®">è´¢ç»èŠ‚ç›®</div>
							<div class="select-item" data-value="æ—¶äº‹è¯„è®º">æ—¶äº‹è¯„è®º</div>
						</div>
						
						<div class="select-category">
							<div class="category-title">
								<i class="fas fa-star"></i> å…¶ä»–åˆ†ç±»
							</div>
							<div class="select-item" data-value="æ•™è‚²èŠ‚ç›®">æ•™è‚²èŠ‚ç›®</div>
							<div class="select-item" data-value="æ–‡åŒ–èŠ‚ç›®">æ–‡åŒ–èŠ‚ç›®</div>
							<div class="select-item" data-value="å®—æ•™èŠ‚ç›®">å®—æ•™èŠ‚ç›®</div>
							<div class="select-item" data-value="å¨±ä¹èŠ‚ç›®">å¨±ä¹èŠ‚ç›®</div>
							<div class="select-item" data-value="å„¿ç«¥èŠ‚ç›®">å„¿ç«¥èŠ‚ç›®</div>
						</div>
					</div>
				</div>
			`;
			
			const selectSelected = customSelect.querySelector('.select-selected');
			const selectItems = customSelect.querySelector('.select-items');
			const selectItemsAll = customSelect.querySelectorAll('.select-item');
			
			selectSelected.addEventListener('click', function(e) {
				e.stopPropagation();
				selectItems.classList.toggle('active');
				this.classList.toggle('select-arrow-active');
			});
			
			selectItemsAll.forEach(item => {
				item.addEventListener('click', function() {
					selectItemsAll.forEach(i => i.classList.remove('active'));
					this.classList.add('active');
					
					selectSelected.textContent = this.textContent;
					if (this.dataset.value === 'all') {
						selectSelected.style.fontWeight = 'bold';
						selectSelected.style.color = '#ff8a00';
					} else {
						selectSelected.style.fontWeight = '';
						selectSelected.style.color = 'white';
					}
					
					currentGenre = this.dataset.value;
					selectItems.classList.remove('active');
					selectSelected.classList.remove('select-arrow-active');
					performSearch();
				});
			});
			
			document.addEventListener('click', function() {
				selectItems.classList.remove('active');
				selectSelected.classList.remove('select-arrow-active');
			});
		}

		// åˆå§‹åŒ–
		document.addEventListener('DOMContentLoaded', function() {
			initMap();
			loadLocalData();
			initCustomSelect();
			
			// åˆå§‹åŠ è½½æ‰€æœ‰åœ°åŒºæ•°æ®
			loadRegionalData('all');
			
			// äº‹ä»¶ç›‘å¬å™¨
			document.getElementById('search-input').addEventListener('input', debounceSearch);
			document.getElementById('country-filter').addEventListener('change', performSearch);
			document.getElementById('language-filter').addEventListener('change', performSearch);
			document.getElementById('load-more-btn').addEventListener('click', loadMoreStations);

			// åœ°åŒºé€‰æ‹©
			document.querySelectorAll('.region-btn').forEach(btn => {
				btn.addEventListener('click', function() {
					document.querySelectorAll('.region-btn').forEach(b => b.classList.remove('active'));
					this.classList.add('active');
					currentRegion = this.dataset.region;
					
					showLoadingState('æ­£åœ¨åŠ è½½åœ°åŒºç”µå°æ•°æ®ï¼Œè¯·ç¨å...');
					
					setTimeout(async () => {
						await loadRegionalData(currentRegion);
						performSearch();
						updateCountryInfo();
					}, 10);
				});
			});

			// éŸ³è´¨é€‰æ‹©
			document.getElementById('quality-select').addEventListener('change', function() {
				currentQuality = this.value;
				performSearch();
			});

			// æ’­æ”¾æ§åˆ¶
			document.getElementById('play-pause-btn').addEventListener('click', togglePlayPause);
			document.getElementById('stop-btn').addEventListener('click', stopPlayback);
			document.querySelector('.volume-slider').addEventListener('input', updateVolume);

			// æ ‡ç­¾é¡µåˆ‡æ¢
			document.querySelectorAll('.tab').forEach(tab => {
				tab.addEventListener('click', function() {
					document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
					document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
					
					this.classList.add('active');
					const tabId = this.dataset.tab;
					document.getElementById(`${tabId}-stations`).classList.add('active');
					
					activeTab = tabId;
					updateTabs();
				});
			});

			// ç§»åŠ¨ç«¯å¸ƒå±€è°ƒæ•´
			window.addEventListener('load', adjustMobileLayout);
			window.addEventListener('resize', adjustMobileLayout);

			// ç§»åŠ¨ç«¯ç‚¹å‡»ç”µå°é¡¹ç›´æ¥æ’­æ”¾
			if (window.innerWidth <= 768) {
				document.addEventListener('touchstart', function(e) {
					const radioItem = e.target.closest('.radio-item');
					if (radioItem && !e.target.closest('.play-btn') && !e.target.closest('.favorite-btn')) {
						const stationId = radioItem.dataset.id;
						playStation(stationId);
					}
				});
			}
		});
	</script>
</body>
</html>
